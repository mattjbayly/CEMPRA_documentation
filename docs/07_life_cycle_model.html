<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Life Cycle Model (Population Model) – CEMPRA Guidance Document</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08_stressor_response_library.html" rel="next">
<link href="./06_r_shiny_app.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/cookie-consent/cookie-consent.js"></script>
<link href="site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3SJZ32N1H9"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-3SJZ32N1H9', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07_life_cycle_model.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Life Cycle Model (Population Model)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CEMPRA Guidance Document</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/mattjbayly/CEMPRA_documentation/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CEMPRA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_stressor_response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Stressor-Response Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_pathways_endpoints.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelling Pathways and Assessment Endpoints</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_initial_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Setup and Installation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_data_inputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Inputs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_r_shiny_app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Joe Model &amp; Shiny App</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_life_cycle_model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Life Cycle Model (Population Model)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_stressor_response_library.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Stressor-Response Library</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_case_study_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Example Datasets</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_r_package_tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">R Package Tutorials</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_conclusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Concluding Remarks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_interaction_matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Multi-Stressor Interaction Matrix</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_socio_economic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Socio-economic Evaluation of Restoration Actions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_formula_builder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">The Formula Builder</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">7.1</span> Overview</a></li>
  <li><a href="#data-input-life-cycle-profiles" id="toc-data-input-life-cycle-profiles" class="nav-link" data-scroll-target="#data-input-life-cycle-profiles"><span class="header-section-number">7.2</span> Data Input: Life Cycle Profiles</a>
  <ul class="collapse">
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose"><span class="header-section-number">7.2.1</span> Purpose</a></li>
  <li><a href="#layout" id="toc-layout" class="nav-link" data-scroll-target="#layout"><span class="header-section-number">7.2.2</span> Layout</a></li>
  </ul></li>
  <li><a href="#matrix-life-cycle-model" id="toc-matrix-life-cycle-model" class="nav-link" data-scroll-target="#matrix-life-cycle-model"><span class="header-section-number">7.3</span> Matrix Life Cycle Model</a>
  <ul class="collapse">
  <li><a href="#anadromous-life-histories" id="toc-anadromous-life-histories" class="nav-link" data-scroll-target="#anadromous-life-histories"><span class="header-section-number">7.3.1</span> Anadromous Life Histories</a></li>
  <li><a href="#vital-rates-for-survivorship-and-growth" id="toc-vital-rates-for-survivorship-and-growth" class="nav-link" data-scroll-target="#vital-rates-for-survivorship-and-growth"><span class="header-section-number">7.3.2</span> Vital Rates for Survivorship and Growth</a></li>
  <li><a href="#vital-rates-for-fecundity" id="toc-vital-rates-for-fecundity" class="nav-link" data-scroll-target="#vital-rates-for-fecundity"><span class="header-section-number">7.3.3</span> Vital Rates for Fecundity</a></li>
  </ul></li>
  <li><a href="#matrix-representations" id="toc-matrix-representations" class="nav-link" data-scroll-target="#matrix-representations"><span class="header-section-number">7.4</span> Matrix Representations</a>
  <ul class="collapse">
  <li><a href="#iteroparous-non-anadromous-species" id="toc-iteroparous-non-anadromous-species" class="nav-link" data-scroll-target="#iteroparous-non-anadromous-species"><span class="header-section-number">7.4.1</span> Iteroparous (Non-anadromous) Species</a></li>
  </ul></li>
  <li><a href="#density-dependent-constraints-on-growth" id="toc-density-dependent-constraints-on-growth" class="nav-link" data-scroll-target="#density-dependent-constraints-on-growth"><span class="header-section-number">7.5</span> Density-Dependent Constraints on Growth</a>
  <ul class="collapse">
  <li><a href="#location-and-stage-specific-carrying-capacities" id="toc-location-and-stage-specific-carrying-capacities" class="nav-link" data-scroll-target="#location-and-stage-specific-carrying-capacities"><span class="header-section-number">7.5.1</span> Location and Stage-Specific Carrying Capacities</a></li>
  <li><a href="#compensation-ratios-for-density-dependent-growth" id="toc-compensation-ratios-for-density-dependent-growth" class="nav-link" data-scroll-target="#compensation-ratios-for-density-dependent-growth"><span class="header-section-number">7.5.2</span> Compensation Ratios for Density-Dependent Growth</a></li>
  </ul></li>
  <li><a href="#stochastic-simulations" id="toc-stochastic-simulations" class="nav-link" data-scroll-target="#stochastic-simulations"><span class="header-section-number">7.6</span> Stochastic Simulations</a>
  <ul class="collapse">
  <li><a href="#eps_sd-standard-deviation-in-eggs-per-spawner" id="toc-eps_sd-standard-deviation-in-eggs-per-spawner" class="nav-link" data-scroll-target="#eps_sd-standard-deviation-in-eggs-per-spawner"><span class="header-section-number">7.6.1</span> eps_sd: Standard Deviation in Eggs-per-Spawner</a></li>
  <li><a href="#egg_rho-correlation-in-egg-fecundity-through-time" id="toc-egg_rho-correlation-in-egg-fecundity-through-time" class="nav-link" data-scroll-target="#egg_rho-correlation-in-egg-fecundity-through-time"><span class="header-section-number">7.6.2</span> egg_rho: Correlation in Egg Fecundity Through Time</a></li>
  <li><a href="#m.cv-coefficient-of-variation-cv-in-interannual-stage-specific-mortality" id="toc-m.cv-coefficient-of-variation-cv-in-interannual-stage-specific-mortality" class="nav-link" data-scroll-target="#m.cv-coefficient-of-variation-cv-in-interannual-stage-specific-mortality"><span class="header-section-number">7.6.3</span> M.cv: Coefficient of Variation (CV) in Interannual Stage-Specific Mortality</a></li>
  <li><a href="#m.rho-correlation-in-stage-class-mortality-through-time" id="toc-m.rho-correlation-in-stage-class-mortality-through-time" class="nav-link" data-scroll-target="#m.rho-correlation-in-stage-class-mortality-through-time"><span class="header-section-number">7.6.4</span> M.rho: Correlation in Stage-Class Mortality Through Time</a></li>
  <li><a href="#p.cat-probability-of-catastrophe-per-generation" id="toc-p.cat-probability-of-catastrophe-per-generation" class="nav-link" data-scroll-target="#p.cat-probability-of-catastrophe-per-generation"><span class="header-section-number">7.6.5</span> p.cat: Probability of Catastrophe per Generation</a></li>
  </ul></li>
  <li><a href="#linking-stressor-response-relationships-to-vital-rates-in-the-population-model" id="toc-linking-stressor-response-relationships-to-vital-rates-in-the-population-model" class="nav-link" data-scroll-target="#linking-stressor-response-relationships-to-vital-rates-in-the-population-model"><span class="header-section-number">7.7</span> Linking Stressor-Response Relationships to Vital Rates in the Population Model</a>
  <ul class="collapse">
  <li><a href="#stressor-response-workbook-structure" id="toc-stressor-response-workbook-structure" class="nav-link" data-scroll-target="#stressor-response-workbook-structure"><span class="header-section-number">7.7.1</span> Stressor-Response Workbook Structure</a></li>
  <li><a href="#the-stressor-response-workbook-parameters-column" id="toc-the-stressor-response-workbook-parameters-column" class="nav-link" data-scroll-target="#the-stressor-response-workbook-parameters-column"><span class="header-section-number">7.7.2</span> The Stressor-Response Workbook ‘Parameters’ Column</a></li>
  <li><a href="#the-stressor-response-workbook-life_stages-column" id="toc-the-stressor-response-workbook-life_stages-column" class="nav-link" data-scroll-target="#the-stressor-response-workbook-life_stages-column"><span class="header-section-number">7.7.3</span> The Stressor-Response Workbook ‘Life_stages’ Column</a></li>
  <li><a href="#stage-specific-tags-recommended" id="toc-stage-specific-tags-recommended" class="nav-link" data-scroll-target="#stage-specific-tags-recommended"><span class="header-section-number">7.7.4</span> Stage-Specific Tags (Recommended)</a></li>
  </ul></li>
  <li><a href="#tips-on-building-a-new-life-cycle-profile-from-scratch" id="toc-tips-on-building-a-new-life-cycle-profile-from-scratch" class="nav-link" data-scroll-target="#tips-on-building-a-new-life-cycle-profile-from-scratch"><span class="header-section-number">7.8</span> Tips on Building a New Life Cycle Profile From Scratch</a></li>
  <li><a href="#benefits-and-limitations" id="toc-benefits-and-limitations" class="nav-link" data-scroll-target="#benefits-and-limitations"><span class="header-section-number">7.9</span> Benefits and Limitations</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Life Cycle Model (Population Model)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/v4nmlRSHo0A" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<section id="overview" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">7.1</span> Overview</h2>
<p>The integrated life cycle model is a core component of the CEMPRA tool. The life cycle modeling component is a valuable endpoint to evaluate and understand cumulative effects through the lens of demographic rates and population ecology. Some user groups may be satisfied with the simplified Joe Modelling (stressor roll-up) component of the CEMPRA tool and, therefore, not wish to interact with the life cycle model. However, other user groups may benefit substantially from working with the life cycle modeling component. Framing cumulative effects through an integrated life cycle model allows us to understand critical bottlenecks to the productivity and capacity of a target study system. In the CEMPRA life cycle modeling component, stressor-response relationships are linked to vital rates such as life-stage-specific survivorship, fecundity, and carrying capacity. Therefore, the life cycle modeling component can be used to make relative comparisons between locations (spatial units), scenarios, and stressors to understand limiting factors and design recovery action strategies.</p>
<p>At its core, the life cycle modeling component of the CEMPRA tool is a stage-structured matrix model (see <span class="citation" data-cites="caswell1997">(<a href="references.html#ref-caswell1997" role="doc-biblioref">Caswell, 1997</a>)</span>). A simplified life cycle profile csv data input file (described below) is populated by the user and then imported to parameterize and construct components of the matrix model (e.g., number of stages, stage-specific survivorship, years in each stage, etc.).</p>
<p>When the life cycle model is run, a hypothetical population is projected forward in time through simulations. The stage-structured matrix model governs the behavior of the simulated population. Density-dependent growth constraints are implemented using either compensation ratios (if the location and stage-specific capacities are unknown) or location and stage-specific Beverton-Holt functions (discussed further below). Location-specific stressor values will interact with the simulated population to curtail or enhance stage-specific survivorship, fecundity, or habitat capacities. Population projections are then compared across scenarios and/or locations to evaluate the relative change in equilibrium abundance estimates for a target life stage (i.e., carrying capacities) and/or the intrinsic productivity (i.e., growth rates) possible at low densities.</p>
<p>The life cycle modeling component of the CEMPRA tool performs a large number of calculations behind the scenes. While convenient, the embedded complexity can create misleading results if input values and assumptions are not carefully considered. It is assumed that users of the life cycle model have an understanding of basic concepts in population ecology (e.g., population growth rates, carrying capacities etc.) and a familiarity with matrix life cycle models. The following resources provide useful refreshers for interested individuals:</p>
<ul>
<li>Basic refresher on matrix life cycle models: <a href="https://compadre-db.org/Education/article/what-is-a-matrix-model" class="uri">https://compadre-db.org/Education/article/what-is-a-matrix-model</a></li>
<li>An in-depth overview of stage-structured matrix models: <a href="https://blog.uvm.edu/tdonovan-vtcfwru/files/2020/06/12-Donov-pages-322-CB.pdf" class="uri">https://blog.uvm.edu/tdonovan-vtcfwru/files/2020/06/12-Donov-pages-322-CB.pdf</a></li>
<li>Density-dependent and density-independent constraints on population growth: <a href="https://www.nature.com/scitable/knowledge/library/population-limiting-factors-17059572/" class="uri">https://www.nature.com/scitable/knowledge/library/population-limiting-factors-17059572/</a></li>
<li>Density-dependent growth functions (review section on the Beverton-Holt function): <a href="http://courses.ecology.uga.edu/ecol4000-fall2018/wp-content/uploads/sites/22/2018/08/Chapter-3-complex-dynamics.pdf" class="uri">http://courses.ecology.uga.edu/ecol4000-fall2018/wp-content/uploads/sites/22/2018/08/Chapter-3-complex-dynamics.pdf</a></li>
</ul>
<p>The model code for the life cycle modeling component of the CEMPRA tool follows a similar structure to the code base used by <span class="citation" data-cites="vanderlee2020">(<a href="references.html#ref-vanderlee2020" role="doc-biblioref">Van der Lee &amp; Koops, 2020</a>)</span>. The underlying code and assessment framework was modified substantially by Dr.&nbsp;Kyle Wilson and Matthew Bayly (M.J. Bayly Analytics Ltd.) throughout 2022 and 2024. Code snippets, functional forms, and rationale largely follow conventional workflow demographic modeling outlined in <span class="citation" data-cites="schaub2021">(<a href="references.html#ref-schaub2021" role="doc-biblioref">Schaub &amp; Kéry, 2021</a>)</span>. For anadromous life cycles with terminal spawners classes, matrix structures follow the generalized design proposed by <span class="citation" data-cites="davison2016">(<a href="references.html#ref-davison2016" role="doc-biblioref">Davison &amp; Satterthwaite, 2016</a>)</span>. Users are encouraged to review these resources for additional background and rationale.</p>
</section>
<section id="data-input-life-cycle-profiles" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="data-input-life-cycle-profiles"><span class="header-section-number">7.2</span> Data Input: Life Cycle Profiles</h2>
<section id="purpose" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="purpose"><span class="header-section-number">7.2.1</span> Purpose</h3>
<p>The life cycle profile is the main input file for the life cycle model. It provides the names and values of key life cycle parameters and vital rates, including parameters for survival, growth, reproduction, and density-dependent effects. This file makes it easy for users to store and edit life cycle parameter values either within or outside of the R Shiny web application. The following sections break down the components of the life cycle profile file with illustrative examples. The intent of the following sections is to provide a detailed explanation of how the life cycle model works with a description of each component of the input file so that users may create their own life cycle profile for a target species of interest.</p>
</section>
<section id="layout" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="layout"><span class="header-section-number">7.2.2</span> Layout</h3>
<p>The life cycle profile is a comma-separated values (CSV) file that contains the names and values of each of the parameters within the life cycle model. Life cycle profiles will be unique to each species or life history variant. The life cycle profile file contains three columns:</p>
<ul>
<li><strong>Parameters</strong>: The full name/description of the parameter. This column can be adjusted by the user to provide more relevant nicknames for each stage (e.g., fry survival, smolt survival etc.). <em>Please update and change these values for your study system.</em></li>
<li><strong>Name</strong>: The short form name of the parameter used in the model. The names of these parameters are referenced by the model code and should not be modified (apart from adding or removing stage classes). <em>Feel free to add or remove rows, depending on the number of stages, but do not change the text in this column.</em></li>
<li><strong>Value</strong>: The numeric value of the parameter used in the model. The values are adjusted for each species profile.</li>
</ul>
<p>The following table shows an example life cycle parameters file for Athabasca Rainbow Trout (non-anadromous).</p>
<table class="caption-top table">
<caption>Example life cycle parameters file for Athabasca Rainbow Trout (non-anadromous)</caption>
<colgroup>
<col style="width: 67%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Parameters</strong></th>
<th><strong>Name</strong></th>
<th><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Number of life stages</td>
<td>Nstage</td>
<td>4</td>
</tr>
<tr class="even">
<td>Anadromous</td>
<td>anadromous</td>
<td>FALSE</td>
</tr>
<tr class="odd">
<td>Adult capacity</td>
<td>k</td>
<td>100</td>
</tr>
<tr class="even">
<td>Spawn events per female</td>
<td>events</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Eggs per female spawn</td>
<td>eps</td>
<td>3000</td>
</tr>
<tr class="even">
<td>spawning interval</td>
<td>int</td>
<td>1</td>
</tr>
<tr class="odd">
<td>egg survival</td>
<td>SE</td>
<td>0.1</td>
</tr>
<tr class="even">
<td>yoy survival</td>
<td>S0</td>
<td>0.3</td>
</tr>
<tr class="odd">
<td>sex ratio</td>
<td>SR</td>
<td>0.5</td>
</tr>
<tr class="even">
<td>Hatchling Survival</td>
<td>surv_1</td>
<td>0.3</td>
</tr>
<tr class="odd">
<td>Juvenile Survival</td>
<td>surv_2</td>
<td>0.3</td>
</tr>
<tr class="even">
<td>Sub-adult Survival</td>
<td>surv_3</td>
<td>0.9</td>
</tr>
<tr class="odd">
<td>Adult Survival</td>
<td>surv_4</td>
<td>0.9</td>
</tr>
<tr class="even">
<td>Years as hatchling</td>
<td>year_1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>years as juvenile</td>
<td>year_2</td>
<td>2</td>
</tr>
<tr class="even">
<td>years as subadult</td>
<td>year_3</td>
<td>2</td>
</tr>
<tr class="odd">
<td>years as adult</td>
<td>year_4</td>
<td>5</td>
</tr>
<tr class="even">
<td>egg survival compensation ratio</td>
<td>cr_E</td>
<td>1</td>
</tr>
<tr class="odd">
<td>yoy survival compensation ratio</td>
<td>cr_0</td>
<td>3</td>
</tr>
<tr class="even">
<td>hatchling survival compensation ratio</td>
<td>cr_1</td>
<td>2.5</td>
</tr>
<tr class="odd">
<td>juvenile survival compensation ratio</td>
<td>cr_2</td>
<td>2</td>
</tr>
<tr class="even">
<td>subadult survival compensation ratio</td>
<td>cr_3</td>
<td>1.1</td>
</tr>
<tr class="odd">
<td>adult survival compensation ratio</td>
<td>cr_4</td>
<td>1</td>
</tr>
<tr class="even">
<td>maturity as hatchling</td>
<td>mat_1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>maturity as juvenile</td>
<td>mat_2</td>
<td>0</td>
</tr>
<tr class="even">
<td>maturity as subadult</td>
<td>mat_3</td>
<td>0</td>
</tr>
<tr class="odd">
<td>maturity as adult</td>
<td>mat_4</td>
<td>1</td>
</tr>
<tr class="even">
<td>variance in eggs per female</td>
<td>eps_sd</td>
<td>1.00E+03</td>
</tr>
<tr class="odd">
<td>correlation in egg fecundity through time</td>
<td>egg_rho</td>
<td>0.1</td>
</tr>
<tr class="even">
<td>coefficient of variation in stage-specific mortality</td>
<td>M.cv</td>
<td>1.00E-01</td>
</tr>
<tr class="odd">
<td>correlation in mortality through time</td>
<td>M.rho</td>
<td>0.1</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="matrix-life-cycle-model" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="matrix-life-cycle-model"><span class="header-section-number">7.3</span> Matrix Life Cycle Model</h2>
<p>The stage-structured matrix modelling framework, embedded within the CEMPRA tool, can be represented graphically by a life cycle diagram (figure) or a transition matrix. The transition matrix can be represented symbolically with either equations (Table 1) or absolute values (Table 2). The structure of the life cycle diagram and transition matrix will be different depending on whether the <strong>anadromous</strong> input is set to TRUE (for anadromous life histories e.g., salmon) or FALSE (for non-anadromous life histories e.g., most trout).</p>
<p>The life cycle diagram figure (below) shows stage class transitions for Athabasca Rainbow Trout. In the diagram and input file, we see that there are four main stages (stage_1 to stage_4). stage_1 individuals can become stage_4 individuals after three years in the simulation, but it is also possible for some individuals to spend more than one year in stages 2, 3, and 4 (denoted by the circular loop). We also see that stage_4 individuals are sexually mature and have the capacity to generate new stage_1 individuals. There are also special year 0 (Age-0) events that occur before new stage_1 (Age-1) individuals are secured in the simulation. These events include egg survival (SE) and Age-0 fry survival (S0).</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-figure28" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image040.png" class="img-fluid figure-img"></p>
<figcaption>Samle life cycle diagram for Athabasca Rainbow Trout.</figcaption>
</figure>
</div>
<p>The life cycle modelling component of the CEMPRA tool is set up as a pre-birth pulse census (see Caswell 2000). Since the design of stage-structured matrix models does not easily allow for the initial number of eggs and fry to be represented as independent matrix elements (cells), their transitions are included within the fecundity term. In a pre-birth pulse census, we assume that the demographic census takes place immediately before spawning (fecundity), meaning that yearlings of the previous spawning year have survived a full time-step (Age-0/stage-0 to Age-1/stage-1). Yearlings (Age-0: egg &amp; fry) must survive the entire census period to the start of the next census. Therefore, the Age-0 transitions (egg-to-fry survivorship: SE and fry-to-parr survivorship: S0) are accounted for within the fecundity element (cells) of the transition matrix (Table 1).</p>
<section id="anadromous-life-histories" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="anadromous-life-histories"><span class="header-section-number">7.3.1</span> Anadromous Life Histories</h3>
<table class="caption-top table">
<caption>Parameter in the life cycle parameters file to trigger the anadromous life history. To use the anadromous life history schedule you must add a row with the parameter name anadromous and then set the value to TRUE. If the anadromous parameter is not specified or missing/excluded from the life cycle parameters inputs file the CEMPRA toolbox will assume that the population is not anadromous.</caption>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Name</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Anadromous</td>
<td>anadromous</td>
<td>TRUE</td>
</tr>
</tbody>
</table>
<p>For semelparous species (such as salmon) we need to impose a slightly different structure to accurately represent a terminal spawner class (B) with death upon reproduction. This can become challenging because we need to also account for the fact that some species such as Coho Salmon, Chinook Salmon, Steelhead etc. will choose to return to spawn at different ages. For example, some Chinook Salmon will return to spawn at age-3, age-4, or age-5 (and sometimes even later). Therefore, the matrix structure needs to represent a dual track for breeders (B) that return to spawn and pre-breeders (P) that remain at sea (or elsewhere) for continued growth. Elegant solutions have been proposed by <span class="citation" data-cites="davison2016">(<a href="references.html#ref-davison2016" role="doc-biblioref">Davison &amp; Satterthwaite, 2016</a>)</span> (and others) to achieve this.</p>
<p>The diagram below illustrates the anadromous life history diagram for Chinook Salmon. In this diagram, there are two pathways available to individual age-2 fish transitioning to age-3 fish. Individuals may return for spawning as breeders (B) (orange boxes) or remain in the marine environment as pre-breeders (Pb) (light blue boxes) for additional years. Pre-breeder (Pb) age classes can have interannual survivorship estimates &gt;0 (to advance fish to older cage classes) but all spawner classes (B-breeders) will die after spawning. The probability of becoming a spawner (at age 3-5) will depend on the portion that become mature at each age class (mat_x). For example, the transition from age-2 (Pb - prebreeders) to age-3 spawners (B - breeders) will be expressed as the baseline marine survivorship from age-2 to age-3 &nbsp;(surv_2) multiplied by the portion of fish that spawn at age-3 (mat_3). Additional migratory mortality for age-3 fish returning to spawn can expressed as (smig_3). Alternatively, age-2 fish can remain at sea for another year to enter the age-3 pre-breeder marine class (stage_Pb_3). This marine transition (stage_Pb_2 to stage_Pb_3) will be expressed as the baseline age-2 to age-3 marine survivorship (surv_2) * the portion of fish that do not spawn at age-3 (1 – mat_3). The cycle repeats itself until the final transition from age-4 to age-5. We assume that age-5 is the maximum possible age any fish can achieve. mat_5 is set 1.0 (100% of remaining individuals return to spawn). No fish will enter into the class (stage_Pb_5 – not shown). We can also set surv_5 to 0, but doing so is not necessary if mat_5 is set to 1.0.</p>
<p>Recruitment of one-year-old fish (stage_Pb_1) is a function of the number of spawners of a given age class (e.g., stage_B_x) multiplied by the average pre-spawn mortality of that age class (u_x), the average fecundity (eggs per female spawner, eps) for that age class (eps_x), the sex ratio (portion female, SR), the average egg survivorship (SE), and finally the average fry survivorship (S0). We can assume the spawning events (events) and interval (int) are both set to 1.0. Therefore, the number of stage_Pb_1 recruits from age-3 spawners would be expressed as (μ_3 * events * eps_3 * SE * s0 * SR)/int.</p>
<p>This diagram can be restructured for Coho, Steelhead, Coastal Cutthroat etc. by adjusting vital rates and then adding or removing age class maturity schedules (see examples at the end of this chapter). We strongly recommend that all implimentations of the CEMPRA anadromous life cycle model for salmon develop an age-based matrix model (Leslie Matrix Models) as a opposed to a stage-based matrix model. We have found that these are less prone to misinterpretations and easier to diagnose.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/anadromous_1.png" class="img-fluid figure-img" alt="Generalized life history stage class transition diagram for anadromous species (example for Chinook Salmon)"></p>
<figcaption>Generalized life history stage class transition diagram for anadromous species (example for Chinook Salmon)</figcaption>
</figure>
</div>
</section>
<section id="vital-rates-for-survivorship-and-growth" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="vital-rates-for-survivorship-and-growth"><span class="header-section-number">7.3.2</span> Vital Rates for Survivorship and Growth</h3>
<p>The CEMPRA tool’s “pre-birth pulse” census assumes that the demographic census occurs just before spawning. This means that individuals counted as yearlings (from the previous spawning season) have already survived one full time-step—from birth (Age-0/Stage-0) to Age-1/Stage-1.</p>
<p>During the first year, two survival rates apply:</p>
<p>SE: Egg survivorship. S0: Sub-yearling (fry) survivorship. Their product (SE × S0) represents the overall early-life survival (surv_0, although it isn’t explicitly modeled).</p>
<p>Once individuals reach Age 1 (Stage 1), the parameter surv_1 governs the density-independent transition to Stage 2. For most anadromous species, which migrate to sea shortly after spawning, surv_1 should be calculated as the product of smolt survivorship and the survival rate during the first several months at sea (up to the individual’s second birthday). For species/life histories that reside in the freshwater environment for longer (e.g., Coho &amp; stream-type Chinook), surv_1 can be adjusted to represent yearling/parr survivorship.</p>
<p>The following table lists the vital rates for survivorship and growth:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 1%">
<col style="width: 98%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nstage</td>
<td><p>The number of stages in the transition matrix (excluding Stage-0/Age-0).</p>
<p>For non-anadromous species: Each stage must span one or more years in the life cycle. In the reference example, there are four stages: stage_1, stage_2, stage_3, and stage_4.</p>
<p>For anadromous species we must assume each year is one stage. In the previous example with Chinook salmon the max age is 5, so there are 5 stages. Do not double-count spawning and non-spawning sub-classes.</p></td>
</tr>
<tr class="even">
<td><p>surv_1</p>
<p>surv_2</p>
<p>surv_3</p>
<p>surv_…</p></td>
<td><p>Mean annual survivorship of individuals in for each stage transition (e.g., surv_1 is the survival of transitioning from stage 1 to stage 2; surv_2 is the survival from stage 2 to stage 3.</p>
<p>Create new rows in the life cycle parameter csv file so that surv_1, surv_2, surv_3, etc. extends to the Nstage.</p>
<p>Similarily delete rows if Nstage is lower that the default csv file. These survivorship estimates should be estimates of intrinsic density-independent survival (in the absence of density-dependent constraints).</p></td>
</tr>
<tr class="odd">
<td><p>year_1</p>
<p>year_2</p>
<p>year_3</p>
<p>year_…</p></td>
<td>The number of years spent in each stage (e.g., year_2 is the number of years spent in stage class 2). Usually these values will all be 1 (one stage = one year). However, individuals in the simulation can spend more than one year in each stage. In the example input file, mature adults can spend up to five years in stage_4. If we were to set the year values to 1 for all stages, then we would have an age-based Leslie matrix model. If additional stages are added (or removed), be sure to modify rows in the life cycle profile CSV file accordingly (i.e., delete or add new rows to match Nstage).</td>
</tr>
<tr class="even">
<td>SE</td>
<td>Egg survivorship (density-independent).</td>
</tr>
<tr class="odd">
<td>S0</td>
<td>Age-0 fry or sub-yearling survivorship (density-independent).</td>
</tr>
</tbody>
</table>
<p><em>Table: Vital rates for survivorship and growth in the life cycle model.</em></p>
<p>Ensure that all survivorship estimates represent hypothetical density-independent survivorship in the absence of density-dependent constraints. Density-dependent survivorship is accounted for in the next section. If density-independent survivorship is unknown, but strong, density-dependent constraints are to be included in the species profile, then it might be possible to simply set the density-independent survivorship estimate to a value close to 1.0 (e.g., S0: 0.999).</p>
<p>For fecundity, we have to consider the proportion of each age class that is sexually mature (mat), the proportion of the population that is female (SR: 0.5), the fecundity (eps: eggs per spawner) per spawning event, the spawning events per year (events), and the spawning interval (int). The calculation of individuals in stage class 1 (stage_1) also must account for the Age-0 survivorship of eggs and fry.</p>
<p><em>Sample fecundity function for stage class 4:</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/image041.png" class="img-fluid figure-img"></p>
<figcaption>Sample fecundity function for non-anadromous simulations</figcaption>
</figure>
</div>
</section>
<section id="vital-rates-for-fecundity" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="vital-rates-for-fecundity"><span class="header-section-number">7.3.3</span> Vital Rates for Fecundity</h3>
<p>The following table lists the vital rates for fecundity:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>mat_1</p>
<p>mat_2</p>
<p>mat_3</p>
<p>mat_…</p>
<p>(1 to Nstage)</p></td>
<td><p>The proportion of each stage class that is sexually mature (0 – 1). For example, in the demo species profile, 100% of the individuals become sexually mature at stage class 4, and the sexual maturity is 0% for all other stage classes. It is also possible for a stage class to have partial maturity (e.g., 0.85). If the Nstage value is different than four, then add or remove rows in the species profile so that the number of mat values matches the number of stage classes (Nstage value).</p>
<p>Anadromous simulations: For some anadromous species such as Chinook salmon, individuals will generally return to spawn between age-3 and age-6. Different populations will have different maturity schedules (e.g., 15% age-3, 70% age-4, 100% age-5 etc.). These values do not need to sum to 100% but age-specific maturity is simply the probability that an individual will become sexually mature and return to spawn at a given age. For anadromous species the oldest age class should have a maturity of 100%, meaning that 100% of individuals at that age class will be ready to spawn.</p></td>
</tr>
<tr class="even">
<td>events</td>
<td>Spawning events per female per year. This parameter will almost always be set to 1 for most species to indicate one spawning event per year per mature female. Even for populations with complex life history variants (e.g., systems with both Spring Chinook &amp; Fall Chinook), we still recommend keeping this value at one and using two different species profiles to represent each life history variant.</td>
</tr>
<tr class="odd">
<td><p><u><em>Fixed Fecundity:</em></u></p>
<p>eps</p>
<p><u><em>Stage-specific Fecundity (anadromous):</em></u></p>
<p>eps_3</p>
<p>esp_4</p>
<p>eps_5</p>
<p>eps_…</p></td>
<td><p>Eggs per spawning female (eps). The mean fecundity per female per spawning event.</p>
<p>Anadromous simulations: For most species we can simply enter an estimate of the mean eggs per female spawner as a fixed global value (e.g., 500 eggs/spawner). However, for some species we may wish to enter in a separate fecundity value for each stage/age class (e.g., Age-3 spawners, eps_3: 3,700; Age-4 spawners, 4,200 eggs/spawner; Age-5 spawners, 5,000 eggs/spawner).</p>
<p>If you choose to enter in age/stage-specific fecundity estimates please delete the row for ‘eps’. If you choose to enter in a fixed global fecundity then delete the age-specific fecundity estimates. Currently age-specific fecundities only works for anadromous simulations.</p></td>
</tr>
<tr class="even">
<td>SR</td>
<td>The sex ratio is represented as the proportion of the population that is female. This value will almost always be set to 0.5 to indicate an equal proportion of males and females in the population.</td>
</tr>
<tr class="odd">
<td>int</td>
<td>Spawning interval (in years). This value will also be set to 1 for most species, indicating that mature individuals spawn each year. <em>Proceed with caution if you choose to use a value other than 1 for this input (see details in formulas)</em>.</td>
</tr>
<tr class="even">
<td><p>smig_3</p>
<p>smig_4</p>
<p>smig_5</p>
<p>…</p></td>
<td><p>(Spawner migration Survivorship Rates: Anadromous simulations only)</p>
<p>Spawner migration survivorship rates for each age class. For example, smig_4 is migratory survivorship for age-4 spawners. These parameters act as a survivorship multiplier. If the spawner migration mortality is 10% then smig_4 should be input as 0.9 (1 - 0.1). These values can be set to 1.0 for initial model setup. Similar to other input parameters check the Nstage value and add or remove rows so that smig_3, smig_4, smig_5 entries are present for each of the mature age classes (anywhere where mat_x is set and is greater than zero).</p></td>
</tr>
<tr class="odd">
<td><p>u_3</p>
<p>u_4</p>
<p>u_5</p>
<p>u_…</p></td>
<td><p>(Prespawn Survivorship Rates: Anadromous simulations only)</p>
<p>Prespawn survivorship rates for each age class. For example u_4 is pre-spawn survivorship for age-4 spawners. These parameters act as a survivorship multiplier. If the prespawn mortality is 10% then u_4 (prespawn survivorship) should be input as 0.9 (1 - 0.1). These values can be set to 1.0 for initial model setup. Similar to other input parameters check the Nstage value and add or remove rows so that u_3, u_4, u_5 entries are present for each of the mature age classes (anywhere where mat_x is set and is greater than zero).</p></td>
</tr>
</tbody>
</table>
<p><em>Table: Vital rates for fecundity in the life cycle model.</em></p>
</section>
</section>
<section id="matrix-representations" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="matrix-representations"><span class="header-section-number">7.4</span> Matrix Representations</h2>
<section id="iteroparous-non-anadromous-species" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="iteroparous-non-anadromous-species"><span class="header-section-number">7.4.1</span> Iteroparous (Non-anadromous) Species</h3>
<p>We can combine all parameters discussed in this section along with the example species profile to construct a symbolic (mathematical) representation of the transition matrix (Table 1). The stage-to-stage transitions account for the probability of staying within each stage or advancing to the next stage based on the <code>surv_X</code> and n-year spent within a stage <code>year_X</code>. The fecundity element of the matrix (top row) includes elements for fecundity and Age-0 survivorship.</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-tbl:transition-matrix">
<p>Table 1. Symbolic Representation of the Transition Matrix for non-anadromous species</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 23%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>stage_1</th>
<th>stage_2</th>
<th>stage_3</th>
<th>stage_4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>stage_1</td>
<td>surv_1 * (1 - surv_1^( year_1 - 1))/(1 - surv_1^ year_1)</td>
<td>(mat2 * events * eps * sE * s0 * sR)/int</td>
<td>(mat3 * events * eps * sE * s0 * sR)/int</td>
<td>(mat4 * events * eps * sE * s0 * sR)/int</td>
</tr>
<tr class="even">
<td>stage_2</td>
<td>surv_1 - surv_1 * (1 - surv_1^(year_1 - 1))/(1 - surv_1^ year_1)</td>
<td>surv_2 * (1 - surv_2^( year_2 - 1))/(1 - surv_2^ year_2)</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>stage_3</td>
<td>0</td>
<td>surv_2 - surv_2 * (1 - surv_2^( year_2 - 1))/(1 - surv_2^ year_2)</td>
<td>surv_3 * (1 - surv_3^( year_3 - 1))/(1 - surv_3^ year_3)</td>
<td>0</td>
</tr>
<tr class="even">
<td>stage_4</td>
<td>0</td>
<td>0</td>
<td>surv_3 - s3 * (1 - surv_3^( year_3 - 1))/(1 - surv_3^ year_3)</td>
<td>surv_4 * (1 - surv_4^( year_4 - 1))/(1 - surv_4^ year_4)</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Do individuals spend more than one year in each stage?</strong></p>
<p>The stage-to-stage transition probabilities are also expressed as functions from <code>surv_X</code> (annual survivorship with stage X) and <code>year_X</code> (number of simulation years within stage X). <code>surv_X</code> is the total annual probability of survival (i.e., regardless of staying within the current stage OR advancing to the next subsequent stage). The example below illustrates how the combined probability of staying within a stage or advancing to the next stage always equals <code>surv_X</code> regardless of n-years in each stage. <em>Note that the sum of the yellow cells equals 0.6 (for both fates of staying within stage or advancing to the next stage).</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/image042.png" class="img-fluid figure-img"></p>
<figcaption>Stage-to-stage transition probabilities</figcaption>
</figure>
</div>
<p>We can continue with the working example to represent the transition matrix numerically (Table 2). The fecundity element for <code>stage_4</code> is set at 45 since it accounts for the vital rates relating to maturity and Age-0 survivorship.</p>
<p>Net Fecundity (stage-4) = (mat4 * events * eps * sE * s0 * sR)/int</p>
<p>45 = (1 * 1 * 3,000 * 0.1 * 0.3 * 0.5)/1</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-tbl:numerical-transition-matrix">
<p>Table 2. Numerical representation of the transition matrix</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>stage_1</th>
<th>stage_2</th>
<th>stage_3</th>
<th>stage_4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>stage_1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>45</td>
</tr>
<tr class="even">
<td>stage_2</td>
<td>0.3</td>
<td>0.231</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>stage_3</td>
<td>0</td>
<td>0.069</td>
<td>0.474</td>
<td>0</td>
</tr>
<tr class="even">
<td>stage_4</td>
<td>0</td>
<td>0</td>
<td>0.426</td>
<td>0.756</td>
</tr>
</tbody>
</table>
</div>
<p>The derived lambda value of the projection matrix (intrinsic rate of growth) in this example species profile is 1.21 (above 1.0), meaning that the population will continue to grow exponentially in the absence of density-dependent constraints.</p>
</section>
</section>
<section id="density-dependent-constraints-on-growth" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="density-dependent-constraints-on-growth"><span class="header-section-number">7.5</span> Density-Dependent Constraints on Growth</h2>
<p>It is rare for natural populations to grow in perpetuity without any constraints on growth, survival, and reproduction. Therefore, life cycle models will typically include a mechanism (or multiple mechanisms) to constrain population growth or limit high densities. We refer to these as density-dependent bottlenecks on population growth.</p>
<p>Stressor-response relationships can be incorporated into the life cycle model without accounting for density-dependent constraints, but the interpretation of the results will be limited to eigen analyses of intrinsic growth rates and sensitivities/elasticities assessments (e.g., comparing lambda values &amp; productivity). While usefule, these outputs are sometimes difficult to communicate to diverse working groups, and they may also be misleading, especially if habitat is limited. If there are key demographic bottlenecks in the life cycle, then a density-independent model may inappropriately lead users to focus on stressors linked to fecundity or early life-stage survivorship before a key bottleneck (e.g., egg-to-fry survivorship) is experienced. However, if (in reality) a population experiences strong density-dependent constraints on growth, then factors limiting habitat availability or productivity of a key life stage will become more influential. A common example of density-independent and density-dependent constraints on growth can be found in the transition between the early life stages of Steelhead (<em>Oncorhynchus mykiss</em>) as individuals transition from egg-to-fry (a density-independent life stage) and then from fry-to-smolts/parr (a density-dependent life stage) <span class="citation" data-cites="ward1993egg">(<a href="references.html#ref-ward1993egg" role="doc-biblioref">Ward &amp; Slaney, 1993</a>)</span>.</p>
<p>The life cycle modeling component of the CEMPRA tool has two (optional) mechanisms to incorporate density-dependent growth constraints. One mechanism makes use of adult carrying capacity and compensation ratios (discussed below), while the second mechanism considers stage and location-specific carrying capacities. Incorporating density-dependent constraints with compensation ratios is convenient because users can evaluate projections in the population model without specifying location-specific habitat availability estimates. However, in most cases incorporating density-dependent constraints with stage and location-specific carrying capacities can provide a more intuitive workflow.</p>
<p><em>We strongly recommend starting with life stage-specific density dependent bottlenecks (e.g., a location is expected to support up to X fry, Y parr, and Z spawners based on habitat availability). Avoid the use of compensation ratios unless you are already familiar with their application in population ecology (most users will tend to find working with compensation ratios a little bit more advanced and sometimes non-intuitive).</em></p>
<p>Both mechanisms of density-dependent constraints utilize the Beverton-Holt function or strict “hockey stick” fixed threshold to constrain the transition probability of key demographic bottlenecks. The Beverton-Holt function calculates the expected number of individuals in the next time step (N at time + 1, or density) as a function of the number of individuals in the current time step (N at time). In the case of stage-structured matrix models, this relationship is expressed as the number of individuals transitioning between two stages (e.g., from stage 2 to stage 3). In the Beverton-Holt function, input parameters governing this relationship include an estimate of stage-specific carrying capacity (K), a baseline estimate of density-independent survival (S) (surv_X from the species profile) for the transition probability, and the number of individuals in the current stage class (Nt) for the simulation year.</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-beverton-holt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image043.png" class="img-fluid figure-img"></p>
<figcaption>Beverton-Holt function for density-dependent growth</figcaption>
</figure>
</div>
<p>The following figure provides an overview of the Beverton-Holt function, showing the number of individuals at time (t) on the x-axis and the number of individuals at time + 1 on the y-axis. For example, this could be the number of Age-0 fry on the x-axis and the number of Age-1+ parr recruits on the y-axis. The curved black line shows the effects of density-dependent growth (limited recruitment as the number of individuals in the first stage is increased). The steep red line is the intrinsic productivity (survivorship, surv_X), which is 0.8 under hypothetical density-independent growth conditions. The blue line is the hypothetical carrying capacity of 100. The “hockey stick” style density dependent method simply applies the horizontal blue dotted line as a fixed threshold that cannot be exceeded.</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-density-dependent" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image044.jpg" class="img-fluid figure-img"></p>
<figcaption>Beverton-Holt function for density-dependent growth</figcaption>
</figure>
</div>
<div>
<p>Beverton-Holt function for density-dependent growth shows the survivorship under density-independent growth (red line), the maximum carrying capacity (blue line), and the resulting relationship from the BH curve (black line).</p>
</div>
<section id="location-and-stage-specific-carrying-capacities" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="location-and-stage-specific-carrying-capacities"><span class="header-section-number">7.5.1</span> Location and Stage-Specific Carrying Capacities</h3>
<p>For more systems with some habitat data and known relationships between habitat availability and maximum densities, it is possible to use location-specific carrying capacities for one or more rate-limiting life stages (e.g., <em>Location X can produce up to 1,200 parr</em>). If this is the case, a special table can be included that specifies the maximum number of individuals per stage class per life stage per location:</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-location-specific" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image045.png" class="img-fluid figure-img"></p>
<figcaption>Location and stage-specific carrying capacity input data table</figcaption>
</figure>
</div>
<div>
<p>Location and stage-specific carrying capacity input data table.</p>
</div>
<p>This table (Location-specific capacities) is referred to as the <em>locations carrying capacity table</em> and exists as a special input file that can be used to control density-dependent growth in the life cycle model. Users must estimate the average carrying capacity for a given life stage at each location (e.g., k_stage_1_mean: 1,200) and (optionally) the interannual variability (CV: coefficient of variation) in the carrying capacity (e.g., k_stage_1_cv: 0.1). If the location carrying capacity table is provided, any cells that are populated with values are assumed to have density-dependent constraints. Any cells that are left blank are assumed to be governed only by density-independent factors and do not have any density-dependent constraints.</p>
<p>In the previous example (Location-specific capacities), the population model will run with constraints on <code>stage_1</code>, meaning that the survivorship from <code>stage_0</code> to <code>stage_1</code> will be governed by a Beverton-Holt relationship, and the abundance (or density) of <code>stage_1</code> individuals will be constrained for each location according to the values provided in the locations carrying capacity table.</p>
<p>The CEMPRA tool does not support the development of these locations and stage-specific carrying capacity estimates, but it’s assumed that relevant reference literature will be used to develop appropriate input values (e.g., if stage 1 is Steelhead parr; regional densities for Steelhead parr are roughly 1,500 parr/km of stream; and fish-accessible reaches within Rock Creek sum up to roughly 800m in length; then k_stage_1_mean should equal roughly 1,200 parr). Developing these estimates alongside a species profile is generally case-specific, but the advantage is that projection from the CEMPRA tool will ultimately account for habitat quality and habitat availability.</p>
<p>For support on estimating upper capacities limits for trout and salmonids in streams from basic habitat data see <span class="citation" data-cites="cramer2009linking">(<a href="references.html#ref-cramer2009linking" role="doc-biblioref">Cramer &amp; Ackerman, 2009</a>)</span> <span class="citation" data-cites="beechie2021modeling">(<a href="references.html#ref-beechie2021modeling" role="doc-biblioref">Beechie et al., 2021</a>)</span>. Other reports can be referenced to estimate capacities in estuaries (e.g., <span class="citation" data-cites="Chen2024ChinookCV">(<a href="references.html#ref-Chen2024ChinookCV" role="doc-biblioref">Chen, 2024</a>)</span>) and lakes (e.g., for Sockeye see: <span class="citation" data-cites="CoxRogersEtAl2010SkeenaSockeye">(<a href="references.html#ref-CoxRogersEtAl2010SkeenaSockeye" role="doc-biblioref">Cox-Rogers et al., 2010</a>)</span>, many other examples exist). To get started we suggest reviewing this great overview video by Nick Ackerman <a href="https://www.youtube.com/watch?v=oSYapG2o4bc" class="uri">https://www.youtube.com/watch?v=oSYapG2o4bc</a>. Most capacity-estimation methods focus on lotic habitats, breaking systems into reaches (e.g., Reach 1, 2, 3) or habitat units such as pools, riffles, and runs. This framework works well for species like Coho, Chinook, Bulltrout, and Steelhead, etc. which rely heavily on stream habitats throughout much of their freshwater life cycle. However, Sockeye differ fundamentally because their spawning and juvenile rearing depend primarily on large lake ecosystems, &amp; only pass through stream reaches. Therefore for Sockeye and other lentic species, it is therefore more appropriate to define model ‘locations’ at the scale of lakes or major basins, and to estimate capacity based on lake productivity and rearing potential rather than reach-scale stream habitat metrics. Stream reaches still matter, particularly for out-migration bottlenecks, migration survival, and tributary spawning where it occurs, but they should be treated as stressors or modifiers, not as the primary units of capacity. We recommend spending time here as group defining the best approach before proceeding with the rest of the modeling.</p>
<p>If the locations carrying capacity table is provided, the population projections will implement density-dependent growth constraints for species-specific life stages according to the stage-specific carrying capacities (with Beverton-Holt constraint on growth or a fixed Hockey-stick style upper capacity threshold), and intrinsic density-independent survivorship estimates. The Steelhead spawners figure shows an example simulation for Steelhead from the CEMPRA tool with adult spawning on the y-axis and a stage-1 (parr) carrying capacity constraint set to 160,000 individuals. In the Steelhead example, the only density-dependent constraint is the parr carrying capacity of the system (set to 160,000). The number of adult spawners is, therefore, a derived metric from the life cycle model. Implementing density-dependent constraints with <em>location and stage-specific carrying capacities</em> is different from the approach with <em>compensation ratios</em>, where users are required to first input an estimate of the adult carrying capacity and work backwards from there.</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-steelhead-spawners" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image047.png" class="img-fluid figure-img"></p>
<figcaption>Simulation of Steelhead Spawners with stage_1 capacity set to 160,000</figcaption>
</figure>
</div>
<div>
<p>Simulation of Steelhead Spawners (y-axis) with stage_1 (parr) capacity set to 160,000.</p>
</div>
<section id="step-1-indentify-which-life-stages-have-denisty-dependent-bottlenecks" class="level4" data-number="7.5.1.1">
<h4 data-number="7.5.1.1" class="anchored" data-anchor-id="step-1-indentify-which-life-stages-have-denisty-dependent-bottlenecks"><span class="header-section-number">7.5.1.1</span> Step 1: Indentify Which Life Stages Have Denisty-Dependent Bottlenecks</h4>
<p>First we identify which life stages have density-dependent bottlenecks and we define these in the life cycle profile csv file. These are generally added to the bottom of the life cycle parameters csv file. This will tell the model where to apply density-dependent bottlenecks and which functions to use.</p>
<p><strong>For Non-anadromous Populations like Rainbow, Bull Trout, Cuttroat, Steelhead etc.</strong></p>
<p>For non-anadromous (iteroparous) populations of resident trout, spawning more than once in their life cycle, the following density-dependent tags are available. Add these to the bottom of the life cycle profile csv in the <strong>Name</strong> column and set <strong>Value</strong> to TRUE.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Mechanism</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>bh_stage_0</code></td>
<td>Beverton–Holt</td>
<td>Egg-to-fry transition limiting the maximum number of fry.</td>
</tr>
<tr class="even">
<td><code>hs_stage_0</code> / <code>dd_hs_0</code></td>
<td>Hockey-Stick</td>
<td>Egg-to-fry hard cap limiting the maximum number of fry.</td>
</tr>
<tr class="odd">
<td><code>bh_stage_1, bh_stage_2, …</code></td>
<td>Beverton–Holt</td>
<td>Stage transitions limiting the maximum number of individuals at that stage with a Beverton–Holt function. For example, bh_stage_1 will limit the maximum number of age-1 individuals (i.e., the fry to parr transition).</td>
</tr>
<tr class="even">
<td><code>hs_stage_1, hs_stage_2, …</code></td>
<td>Hockey-Stick</td>
<td><em>Same as above but with a hockey-stick style hard cap.</em> For example, hs_stage_1 will be applied at the fry to age-1 transition limiting the number of stage 1 individuals (e.g., fry to parr). hs_stage_2 will limit the stage 1 to stage 2 transition and limit the number of stage 2 individuals.</td>
</tr>
<tr class="odd">
<td><code>bh_spawners</code></td>
<td>Beverton–Holt</td>
<td>Total spawner capacity. Will limit the number of adults across all spawning stage classes (references maturity probability to determine spawner vs non-spawner).</td>
</tr>
<tr class="even">
<td><code>hs_spawners</code></td>
<td>Hockey-Stick</td>
<td>Total spawner cap. <em>Same as above, but with fixed upper limit as a hard stop threshold.</em></td>
</tr>
</tbody>
</table>
<p><strong>For Anadromous Populations like Chinook, Coho, Sockeye, Chum, Pink etc.</strong></p>
<p>For anadromous (semelparous) populations of salmon, spawning only once in their life cycle and then dying, the following density-dependent tags are available. Add these to the bottom of the life cycle profile csv in the <strong>Name</strong> column and set <strong>Value</strong> to TRUE. The tags are similar to the above tags for non-anadromous life history profiles but we must include define pb (for pre-breeder) vs b (for breeder), becomes more important for later life stages.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Mechanism</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>bh_stage_0</code></td>
<td>Beverton–Holt</td>
<td>Egg-to-fry transition limiting the maximum number of fry (this tag is the same for non-anadromous and does not need ‘pb’ or ‘b’ to be specified).</td>
</tr>
<tr class="even">
<td><code>hs_stage_0</code></td>
<td>Hockey-Stick</td>
<td>Egg-to-fry hard cap limiting the maximum number of fry (this tag is the same for non-anadromous and does not need ‘pb’ or ‘b’ to be specified).</td>
</tr>
<tr class="odd">
<td><p><code>bh_stage_pb_1, bh_stage_pb_2, …</code></p>
<p><code>bh_stage_b_1, bh_stage_b_2, …</code></p></td>
<td>Beverton–Holt</td>
<td><p>Stage transitions limiting the maximum number of individuals at that (pb - pre-breeder) stage with a Beverton–Holt function. For example, bh_stage_pb_1 will limit the maximum number of age-1 individuals (i.e., commonly used for the fry to parr transition to limit the number of parr).</p>
<p>The ‘pb’ tag indicates that the constraint will be applied to the pre-breeder stage class, while the ‘b’ tag indicates that the DD constraint will be applied to a specific spawner stage class. The latter is somewhat awkward for populations with multiple spawner stage classes, so ‘bh_spawners’ was included for convenience (see below)</p></td>
</tr>
<tr class="even">
<td><p><code>hs_stage_pb_1, hs_stage_pb_2, …</code></p>
<p><code>hs_stage_b_1, hs_stage_b_2, …</code></p></td>
<td>Hockey-Stick</td>
<td><em>Same as above but with a hockey-stick style hard cap.</em> For example, hs_stage_pb_1 will be applied at the fry to age-1 transition limiting the number of stage 1 individuals (e.g., fry to parr). hs_stage_pb_2 will limit the stage 1 to stage 2 transition and limit the number of stage 2 individuals.</td>
</tr>
<tr class="odd">
<td><code>bh_spawners</code></td>
<td>Beverton–Holt</td>
<td><p>Total spawner capacity. Will limit the number of adults across all spawning stage classes (references maturity probability to determine spawner vs non-spawner).</p>
<p>Use this to apply a density-dependent constrain on adult spawners (pooled across spawner age classes).</p></td>
</tr>
<tr class="even">
<td><code>hs_spawners</code></td>
<td>Hockey-Stick</td>
<td>Total spawner cap. <em>Same as above, but with fixed upper limit as a hard stop threshold.</em></td>
</tr>
</tbody>
</table>
<p><strong>Select Target Density-Dependent Bottlenecks and Update the Life Cycle Profile File.</strong></p>
<p>We then need to select target density-dependent bottlenecks of interest (from the name tags above) and update the life cycle profile file to tell the model which life stages have density-dependent constraints and which functions to use (e.g., bh vs hs).</p>
<p>The file life cycle profile files should look something like this. Use the exact naming convention in the Name column, set the Value column to TRUE and provide a custom entry in the Parameters column as a user-friendly reminder of which life stage the density-dependent constraint is being applied to.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lcp_non_anadromous.png" class="img-fluid figure-img" alt="Updated life cycle profile file for a non-anadromous population with several density-dependent functions added"></p>
<figcaption>Updated life cycle profile file for a non-anadromous population with several density-dependent functions added to the model</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lcp_anadromous.png" class="img-fluid figure-img"></p>
<figcaption>Updated life cyle profile csv file for an anadromous species with three density-dependent functions added to the model.</figcaption>
</figure>
</div>
</section>
<section id="step-2-create-the-location-specific-habitat-capacities-file" class="level4" data-number="7.5.1.2">
<h4 data-number="7.5.1.2" class="anchored" data-anchor-id="step-2-create-the-location-specific-habitat-capacities-file"><span class="header-section-number">7.5.1.2</span> Step 2: Create the Location-Specific Habitat Capacities File</h4>
<p>In the previous step we told the model which life stages have density-dependent constraints and which density-dependent functions to use, but will still need to specify the location-specific K (capacity) values for each life stage. For example, if we know we have density-dependent constraints on egg-to-fry, fry-to-parr, and spawners, we need to specify the upper carrying capacities for each of fry, parr, and spawners for each location. We enter this information in the habitat capacities file.</p>
<p>The habitat capacities file can be generated as an Excel or csv file and defines the upper carrying capacity for each location (as rows) and each life stage at the target location (column values). The habitat capacities file always begins with columns HUC_ID (location id) and NAME (location or reach name), and then includes a series of wildcard columns that define the maximum number of individuals that the location is able to support for that life stage. See the examples below:</p>
<p><strong>Example Habitat Capacities File for a Non-Anadromous Population</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 22%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>HUC_ID</strong></td>
<td><strong>NAME</strong></td>
<td><strong>k_stage_0_mean</strong></td>
<td><strong>k_stage_1_mean</strong></td>
<td><strong>k_stage_3_mean</strong></td>
</tr>
<tr class="even">
<td>1</td>
<td>Reach 1</td>
<td>627,594</td>
<td>238,987</td>
<td>38,073</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Reach 2</td>
<td>1,247,555</td>
<td>537,196</td>
<td>15,384</td>
</tr>
<tr class="even">
<td>3</td>
<td>Reach 3</td>
<td>913,589</td>
<td>359,136</td>
<td>20,943</td>
</tr>
</tbody>
</table>
<p>In the previous table we have the HUC_ID &amp; NAME columns for the location - to link information to the stressor data, and then we have a series of additional columns:</p>
<ul>
<li><p>k_stage_0_mean: defines the carrying capacity K for stage_0 (fry) at the location. In this case it is set to 627,594 for reach 1. If we defined the density-dependent function in the life cycles file ‘hs_stage_0’ to TRUE, then the simulated population would be restricted to fry abundance to &lt;627,594 at location 1, regardless of the productivity.</p></li>
<li><p>k_stage_1_mean: We also include values for stage_1 capacity (K) limits. In this example this constraints corresponds to the parr carrying capacity. If we set ‘hb_stage_1’ to TRUE in the life cycle file then the values in this column would create a bottleneck at the fry to parr transition and restrict the number of stage 1 individuals.</p></li>
<li><p>k_stage_3_mean: Similar to above this column will control the number of stage_3 individuals. Likely a stage representing adults.</p></li>
</ul>
<p>We can also add additional columns for k_stage_4_mean etc. provided that they are defined in the life cycles file. Next we show an example for an anadromous population.</p>
<p><strong>Example Habitat Capacities File for an Anadromous Population</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 21%">
<col style="width: 25%">
<col style="width: 22%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>HUC_ID</strong></td>
<td><strong>NAME</strong></td>
<td><strong>k_stage_0_mean</strong></td>
<td><strong>k_stage_Pb_1_mean</strong></td>
<td><strong>k_spawners_mean</strong></td>
</tr>
<tr class="even">
<td>1</td>
<td>Reach 1</td>
<td>627,594</td>
<td></td>
<td>38,073</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Reach 2</td>
<td>1,247,555</td>
<td></td>
<td>15,384</td>
</tr>
<tr class="even">
<td>3</td>
<td>Reach 3</td>
<td>913,589</td>
<td></td>
<td>20,943</td>
</tr>
</tbody>
</table>
<p>In the previous table we have the HUC_ID &amp; NAME columns for the location - to link information to the stressor data, and then we have a series of additional columns. These are similar to but slightly different than the non-anadromous populations because we need to specify Pb (pre-breeder) vs B (breeder):</p>
<ul>
<li><p>k_stage_0_mean: defines the carrying capacity K for stage_0 (fry) at the location. In this case it is set to 627,594 for reach 1. If we defined the density-dependent function in the life cycles file ‘hs_stage_0’ to TRUE, then the simulated population would be restricted to fry abundance to &lt;627,594 at location 1, regardless of the productivity. <em>We do not need to define pb/b for the fry stage class.</em></p></li>
<li><p>k_stage_Pb_1_mean: We also include values for stage_1 capacity (K) limits. In this example this constraints corresponds to the parr carrying capacity. The ‘Pb’ applies to the pre-breeder stage class in the anadromous model. If we set ‘hs_stage_pb_1’ to TRUE in the life cycle file then the values in this column would create a bottleneck at the fry to parr transition and restrict the number of stage 1 individuals.</p></li>
<li><p>k_spawners_mean: Here we specify the carrying capacity for adult spawners across all age classes (alt column names like k_stage_b_mean will also work). This column will control the maximum number of spawners pooled across all spawner age classes. You can also specify capacities for spawner age classes individually (e.g., k_stage_B_4_mean, k_stage_B_5_mean, etc.) but that can get tricky since it assumes the portions are well-known and consistent.</p></li>
</ul>
<p><em>Note that the values in the column are empty - if no data is available then the model will be run with capacity set in Inf for that life stage.</em></p>
</section>
<section id="step-3-final-checks" class="level4" data-number="7.5.1.3">
<h4 data-number="7.5.1.3" class="anchored" data-anchor-id="step-3-final-checks"><span class="header-section-number">7.5.1.3</span> Step 3: Final Checks</h4>
<ul>
<li><p>Define stage/age classes with known or expected density dependent constraints</p></li>
<li><p>Update the life cycle profile file to include target density dependent bottlenecks with their associated functions (e.g., <code>hs_stage_0, bh_spawners etc.</code>). Set the Value column to TRUE so they will be applied in the model</p></li>
<li><p>Create or update the habitat capacities file. Define the K capacity values for each location and life stage.</p></li>
<li><p><strong>Reccomended</strong>: Run the model in the Shiny app to ensure it is functioning as intended.</p></li>
</ul>
</section>
</section>
<section id="compensation-ratios-for-density-dependent-growth" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="compensation-ratios-for-density-dependent-growth"><span class="header-section-number">7.5.2</span> Compensation Ratios for Density-Dependent Growth</h3>
<p>It is possible to implement density-dependent constraints with both the compensation ratios and the location and stage-specific carrying capacities, but we recommend using only one mechanism for density-dependent growth to avoid confusion.</p>
<p>Compensation ratios (CR values) can be used in the CEMPRA life cycle model to parameterize and control density-dependent growth. Compensation ratios (described below) are a reparameterization of the classical Beverton-Holt function for density-dependent growth.</p>
<p><em>We recommend that users who are unfamiliar with compensation ratios &amp; advanced methods in population ecology avoid compensation ratios and stick to stage-specific carrying capacities.</em></p>
<p>Compensation Ratios (CR) adjust the survivorship of each life stage based on the observed densities (abundance, N i,t) and stage-specific carrying capacities (Ki):</p>
<section id="compensation-ratio-cr-for-life-stage-i" class="level4" data-number="7.5.2.1">
<h4 data-number="7.5.2.1" class="anchored" data-anchor-id="compensation-ratio-cr-for-life-stage-i"><span class="header-section-number">7.5.2.1</span> Compensation Ratio CR for life stage i:</h4>
<p>The compensation ratio for life stage i adjusts the survivorship of each life stage based on the observed densities (abundance, Ni,t) and stage-specific carrying capacities (Ki):</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-compensation-ratio" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image048.png" class="img-fluid figure-img"></p>
<figcaption>Compensation Ratio CR for life stage i</figcaption>
</figure>
</div>
<p>In the CR equation above, Si,0 is the baseline survivorship (surv_X) under density-independent growth conditions; wi is the compensation ratio (CR value) of life stage i; Ni,t is the current number of individuals in life stage i in a given time step (t); and Ki is the carrying capacity of life stage i. The compensation ratios, in essence, modify the survivorship of each life stage based on how far the stage-specific abundance (Ni,t) has departed from its assumed carrying capacity (Ki).</p>
<p>A plot of compensation ratios is provided below to illustrate their effects on stage-specific survivorship transitions. In this example, abundance values of a hypothetical stage class (i) are plotted along the x-axis with a carrying capacity (Ki) set to 100 individuals (blue vertical line). The hypothetical stage class (i) has a baseline survivorship (productivity) value of 0.8 in the absence of density-dependent growth conditions (horizontal red line). The y-axis on the plot shows how the default survivorship value of 0.8 is modified based on the stage-specific compensation ratio for stage class (CRi). The survivorship value for the stage class is suppressed as the abundance values exceed the carrying capacity K. The effects are amplified as compensation ratios are increased. Compensation ratios of 1.0 leave the vital rate unmodified. Compensation ratios less than 1.0 increase survivorship values (allowing for a potential positive effect of density). When the abundance of the age class is less than the carrying capacity, baseline survivorship values can actually increase. However, within the model code, adjusted survivorship values are fixed so that they never exceed 1.0 for any stage transition.</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-compensation-ratios-effect" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image049.jpg" class="img-fluid figure-img"></p>
<figcaption>Influence of compensation ratios on stage-specific survivorship</figcaption>
</figure>
</div>
<div>
<p>Influence of compensation ratios on stage-specific survivorship.</p>
</div>
</section>
<section id="compensation-ratios-stage-specific-carrying-capacity-estimates" class="level4" data-number="7.5.2.2">
<h4 data-number="7.5.2.2" class="anchored" data-anchor-id="compensation-ratios-stage-specific-carrying-capacity-estimates"><span class="header-section-number">7.5.2.2</span> Compensation Ratios &amp; Stage-Specific Carrying Capacity Estimates:</h4>
<p>When using compensation ratios, it is only possible to modify the carrying capacity for the adult age class via the K parameter in the life cycle profile. The K values for other age classes are derived from the stable-stage distribution of the underlying transition matrix. This means that users who implement density-dependent growth via compensation ratios can only modify stage-specific abundance relative to the stable stage distribution. If you know (or can estimate) critical location-specific and stage-specific capacities (e.g., maximum stage_1 parr at location X), then refer to Section 8.4.1 to implement density-dependent growth constraints with location and stage-specific carrying capacities.</p>
<p>Stage-specific capacities (K) with compensation ratios:</p>
<ul>
<li>K (Stage-0, eggs): Calculated as the product of the number of individuals in all mature age classes, multiplied by maturation probabilities for each class, the number of spawning events, eggs per female, sex ratio and spawning interval.</li>
<li>K (Stage-0, fry): K values for young-of-the-year (fry/Age-0) individuals are calculated as the product of K (Stage-0, eggs) * the egg survival (SE).</li>
<li>K (Stage-1): Calculated from the stable-stage distribution of the transition matrix (B) after setting the adult stage (Stage-4) to K (e.g., 100).</li>
<li>K (Stage-2): Calculated from the stable-stage distribution of the transition matrix (B) after setting the adult stage (Stage-4) to K (e.g., 100).</li>
<li>K (Stage-3): Calculated from the stable-stage distribution of the transition matrix (B) after setting the adult stage (Stage-4) to K (e.g., 100).</li>
<li>K (Stage-4): Manually input by the user for the population of interest. This assumes that stage-4 is the only mature age class.</li>
</ul>
<p>Stable-stage distribution (portions) under the example species profile <span class="quarto-unresolved-ref">?fig-figure27</span>:</p>
</section>
<section id="stable-stage-distributions-as-a-fraction-0---1-stage-specific-carrying-capacities-k" class="level4" data-number="7.5.2.3">
<h4 data-number="7.5.2.3" class="anchored" data-anchor-id="stable-stage-distributions-as-a-fraction-0---1-stage-specific-carrying-capacities-k"><span class="header-section-number">7.5.2.3</span> Stable Stage Distributions (as a fraction 0 - 1) &amp; Stage-specific Carrying Capacities (K):</h4>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-stable-stage-distributions" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image050.png" class="img-fluid figure-img"></p>
<figcaption>Stable Stage Distributions and Stage-specific Carrying Capacities</figcaption>
</figure>
</div>
</section>
<section id="compensation-ratios-and-the-density-dependence-matrix-d" class="level4" data-number="7.5.2.4">
<h4 data-number="7.5.2.4" class="anchored" data-anchor-id="compensation-ratios-and-the-density-dependence-matrix-d"><span class="header-section-number">7.5.2.4</span> Compensation Ratios and the Density-Dependence Matrix (D):</h4>
<p>Based on the derived stage-specific carrying capacities (K values), baseline survivorship values (SE, S0, surv_1, …) and the corresponding compensation ratios (cr_E, cr_0, cr_1, …), a density-dependence matrix (D) for a hypothetical population vector of eggs: 10,000,000, fry: 1,000,000; stage 1: 100,000, stage 2: 10,000, stage 3: 1,000 &amp; stage 4: 100 will appear as follows:</p>
<p>The density-dependence matrix (D) contains vital rate modifiers for the estimated survivorship values at each stage transition. The density-dependence matrix (D) is multiplied with the corresponding transition matrix (B, Table 2) of density-independent transition probabilities. The finalized projection matrix (A) is the product of the density-dependent matrix (D), and the transition matrix (B) [A is a product of B*D = A]. The density-dependent matrix changes with each time step based on the number of individuals. The projection matrix (A) is, therefore, recalculated for each time step.</p>
<p>Compensation ratios are widely used as parameters in stock-recruitment functions, although they are admittedly less popular in classical matrix life cycle modeling. Steepness (the proportion of recruitment produced when stock size is reduced to 20% of initial biomass) is sometimes used in place of compensation ratios. Numerous other methods exist to introduce density dependence into stage-structured life cycle models. The compensation ratios are available as a default option for the CEMPRA tool to represent a versatile mechanism for applications to a large number of hypothetical species profiles. If location and stage-specific carrying capacities can be estimated, we recommend users set all compensation ratios to 1.0 for each stage class (therefore omitting compensation ratios) and refer to Section 8.4.1 for classical density-dependent growth with Beverton-Holt functions. For additional background, please review the following references to learn more about compensation ratios and life cycle modeling with density-dependent growth.</p>
<p><strong>Compensation Ratios in the Species Profile</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 89%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td>cr_E, cr_0, cr_1, cr_2, cr_3, cr_4</td>
<td>The compensation ratios for egg (cr_E), Age-0 fry (cr_0) and subsequent stage classes (cr_1 to cr_4) can be set. If the Nstage value is different than four, then add or remove rows accordingly. Compensation ratios can be set to 1.0 to omit the use of compensation ratios to govern density-dependent growth.</td>
</tr>
</tbody>
</table>
</section>
<section id="useful-references-to-understand-compensation-ratios" class="level4" data-number="7.5.2.5">
<h4 data-number="7.5.2.5" class="anchored" data-anchor-id="useful-references-to-understand-compensation-ratios"><span class="header-section-number">7.5.2.5</span> Useful references to understand Compensation Ratios:</h4>
<p>To further understand compensation ratios and their application in life cycle modeling, the following references are recommended:</p>
<ul>
<li>Goodyear, C. P. (1980). Compensation in fish populations. Biological monitoring of fish, 253-280.</li>
<li>Myers, R. A. (2001). Stock and recruitment: generalizations about maximum reproductive rate, density dependence, and variability using meta-analytic approaches. ICES Journal of Marine Science, 58(5), 937-951.</li>
<li>Rose, K. A., Cowan Jr, J. H., Winemiller, K. O., Myers, R. A., &amp; Hilborn, R. (2001). Compensatory density dependence in fish populations: importance, controversy, understanding and prognosis. Fish and Fisheries, 2(4), 293-327.</li>
<li>Myers, R. A., Bowen, K. G., &amp; Barrowman, N. J. (1999). Maximum reproductive rate of fish at low population sizes. Canadian Journal of Fisheries and Aquatic Sciences, 56(12), 2404-2419.</li>
<li>Walters, C. J., &amp; Martell, S. J. (2004). Fisheries ecology and management. Princeton University Press.</li>
<li>Forrest, R. E., McAllister, M. K., Dorn, M. W., Martell, S. J., &amp; Stanley, R. D. (2010). Hierarchical Bayesian estimation of recruitment parameters and reference points for Pacific rockfishes (Sebastes spp.) under alternative assumptions about the stock–recruit function. Canadian Journal of Fisheries and Aquatic Sciences, 67(10), 1611-1634.</li>
</ul>
</section>
</section>
</section>
<section id="stochastic-simulations" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="stochastic-simulations"><span class="header-section-number">7.6</span> Stochastic Simulations</h2>
<p>Several additional parameters are available to influence the stochasticity (variability) of the population projections. Implementing these parameters is useful for understanding the viability of the population and (over many simulations) estimating the number of batch replicates that fall below a given critical threshold (e.g., X adults).</p>
<section id="eps_sd-standard-deviation-in-eggs-per-spawner" class="level3" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="eps_sd-standard-deviation-in-eggs-per-spawner"><span class="header-section-number">7.6.1</span> eps_sd: Standard Deviation in Eggs-per-Spawner</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 2%">
<col style="width: 97%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>eps_sd</code></td>
<td>The Standard Deviation in Eggs-per-Spawner controls the variability in fecundity across simulation years and batch replicates. The example below shows a sample projection with <code>eps_sd</code> set to 250 and 750. In the example with <code>eps_sd</code> set to 750, there are several years with very high fecundity. Density-dependent constraints (if implemented) may attenuate the apparent effect of high <code>eps_sd</code> inputs.</td>
</tr>
</tbody>
</table>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-eps-sd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image051.png" class="img-fluid figure-img"></p>
<figcaption>eps_sd Standard Deviation in Eggs-per-Spawner</figcaption>
</figure>
</div>
<div>
<p>eps_sd Standard Deviation in Eggs-per-Spawner</p>
</div>
</section>
<section id="egg_rho-correlation-in-egg-fecundity-through-time" class="level3" data-number="7.6.2">
<h3 data-number="7.6.2" class="anchored" data-anchor-id="egg_rho-correlation-in-egg-fecundity-through-time"><span class="header-section-number">7.6.2</span> egg_rho: Correlation in Egg Fecundity Through Time</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 1%">
<col style="width: 98%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>egg_rho</code></td>
<td>In natural populations, there will be good years and bad years. It’s assumed that good years will be good for large adults and small adults. If multiple mature stage classes contribute to spawning (fecundity) (i.e., maturity values are greater than 0), it is assumed that fecundity will be correlated between good and bad years across stage classes (i.e., stage_5, stage_6 &amp; stage_7). <code>egg_rho</code> controls the degree of correlation in interannual fecundity between stage classes. See the following figure for an illustrative example. If <code>egg_rho</code> is low, and multiple stage classes contribute to spawning, then some stage classes may compensate for good/bad years. Conversely, if <code>egg_rho</code> is high, then the population may be highly volatile as all cohorts experience good/bad years simultaneously.</td>
</tr>
</tbody>
</table>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-egg-rho" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image052.png" class="img-fluid figure-img"></p>
<figcaption>egg_rho: correlation in egg fecundity through time</figcaption>
</figure>
</div>
<div>
<p>egg_rho: correlation in egg fecundity through time</p>
</div>
</section>
<section id="m.cv-coefficient-of-variation-cv-in-interannual-stage-specific-mortality" class="level3" data-number="7.6.3">
<h3 data-number="7.6.3" class="anchored" data-anchor-id="m.cv-coefficient-of-variation-cv-in-interannual-stage-specific-mortality"><span class="header-section-number">7.6.3</span> M.cv: Coefficient of Variation (CV) in Interannual Stage-Specific Mortality</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 96%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>M.cv</code></td>
<td>The Coefficient of Variation (CV) in stage-specific mortality (<code>M.cv</code>) is based on a beta distribution. This parameter allows for the modeling of variability in mortality rates across different life stages, contributing to a more dynamic and realistic simulation of population dynamics.</td>
</tr>
</tbody>
</table>
</section>
<section id="m.rho-correlation-in-stage-class-mortality-through-time" class="level3" data-number="7.6.4">
<h3 data-number="7.6.4" class="anchored" data-anchor-id="m.rho-correlation-in-stage-class-mortality-through-time"><span class="header-section-number">7.6.4</span> M.rho: Correlation in Stage-Class Mortality Through Time</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 1%">
<col style="width: 98%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>M.rho</code></td>
<td><code>M.rho</code>, the correlation in mortality through time, plays a critical role in modeling the variability of survivorship across life stages. In natural populations, the occurrence of good and bad years is often correlated across all stage classes, excluding eggs (<code>SE</code>). <code>M.rho</code> determines the degree of this correlation. A low <code>M.rho</code> value suggests that certain stage classes may compensate for good/bad years based on random sampling of survivorship, while a high <code>M.rho</code> implies that all cohorts may experience good/bad years simultaneously, leading to higher volatility in population dynamics.</td>
</tr>
</tbody>
</table>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-m-rho" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image053.png" class="img-fluid figure-img"></p>
<figcaption>M.rho: correlation in survivorship through time</figcaption>
</figure>
</div>
<div>
<p>M.rho: correlation in survivorship through time</p>
</div>
</section>
<section id="p.cat-probability-of-catastrophe-per-generation" class="level3" data-number="7.6.5">
<h3 data-number="7.6.5" class="anchored" data-anchor-id="p.cat-probability-of-catastrophe-per-generation"><span class="header-section-number">7.6.5</span> p.cat: Probability of Catastrophe per Generation</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 96%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>p.cat</td>
<td><code>p.cat</code> represents the Probability of Catastrophe per Generation. This parameter is scaled to the average generation time of the population, reflecting the annual probability of a catastrophic event occurring. It’s a critical factor in assessing the resilience and long-term sustainability of a population under varying environmental and anthropogenic pressures.</td>
</tr>
</tbody>
</table>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-p-cat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image054.png" class="img-fluid figure-img"></p>
<figcaption>Probability of Catastrophe per Generation</figcaption>
</figure>
</div>
<div>
<p>p.cat: Probability of Catastrophe per Generation</p>
</div>
</section>
</section>
<section id="linking-stressor-response-relationships-to-vital-rates-in-the-population-model" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="linking-stressor-response-relationships-to-vital-rates-in-the-population-model"><span class="header-section-number">7.7</span> Linking Stressor-Response Relationships to Vital Rates in the Population Model</h2>
<p>Up to this point, we have only created a general population model, but we have not yet linked any of our stressors or stressor-response relationships to the life cycle model. In this section we will go over how to define linkages between each of the stressor response relationships and specific vital rates in the population model.</p>
<p>A key feature of the population model is the ability to link environmental stressors directly to <strong>life-stage-specific vital rates</strong>. This is configured in the <strong>Stressor-Response Excel Workbook</strong> through the <code>Life_stages</code> and <code>Parameters</code> columns on the Main worksheet.</p>
<section id="stressor-response-workbook-structure" class="level3" data-number="7.7.1">
<h3 data-number="7.7.1" class="anchored" data-anchor-id="stressor-response-workbook-structure"><span class="header-section-number">7.7.1</span> Stressor-Response Workbook Structure</h3>
<p>Recall from earlier chapters and the <a href="https://essatech.github.io/CEMPRA/articles/a01-joe-model.html">Joe Model Tutorials</a> that the stressor-response workbook contains a <strong>Main</strong> worksheet that indexes all stressors. For the population model, two additional columns become critical (the Life_stages and the Parameters columns).</p>
<p>By carefully defining these columns we can effecively link stressor-response relationships to specific vital rates. However, each stressor-response relationship can be linked to only one vital rate. If multiple linkages are desired then duplicate the stressor &amp; stressor-response relationship accordingly in the Stressor Magnitude and Stressor-Response workbook (e.g., SummerStreamTemp_Parr, SummerStreamTemp_Prespawn).</p>
</section>
<section id="the-stressor-response-workbook-parameters-column" class="level3" data-number="7.7.2">
<h3 data-number="7.7.2" class="anchored" data-anchor-id="the-stressor-response-workbook-parameters-column"><span class="header-section-number">7.7.2</span> The Stressor-Response Workbook ‘Parameters’ Column</h3>
<p>The in the Stressor-Response workbook <code>Parameters</code> column specifies <strong>how</strong> the stressor-response relationship affects the vital rate of interest. There are three possible values:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Value</th>
<th>Effect</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>capacity</code></td>
<td>Reduces carrying capacity</td>
<td>The stressor reduces the maximum number of individuals that habitat can support at the target life stage (K). This affects density-dependent regulation.</td>
</tr>
<tr class="even">
<td><code>survival</code></td>
<td>Reduces survival probability</td>
<td>The stressor directly reduces the survival rate (S) for the target life stage. This is a density-independent effect.</td>
</tr>
<tr class="odd">
<td><code>fecundity</code></td>
<td>Reduces reproductive output</td>
<td>The stressor reduces eggs per spawner (eps). Less commonly used.</td>
</tr>
<tr class="even">
<td><em>blank</em> or <code>NA</code></td>
<td>Joe Model only</td>
<td>The stressor contributes to system capacity but is not linked to the population model.</td>
</tr>
</tbody>
</table>
<p><strong>Example interpretation:</strong></p>
<ul>
<li>A stressor with <code>Parameters = "capacity"</code> and <code>Life_stages = "stage_0"</code> reduces the fry carrying capacity. If the system capacity score is 0.70, the fry capacity (K0) is reduced to 70% of baseline.</li>
<li>A stressor with <code>Parameters = "survival"</code> and <code>Life_stages = "stage_1"</code> reduces stage-1 survival. If the system capacity score is 0.85, the stage-1 survival rate is multiplied by 0.85.</li>
</ul>
</section>
<section id="the-stressor-response-workbook-life_stages-column" class="level3" data-number="7.7.3">
<h3 data-number="7.7.3" class="anchored" data-anchor-id="the-stressor-response-workbook-life_stages-column"><span class="header-section-number">7.7.3</span> The Stressor-Response Workbook ‘Life_stages’ Column</h3>
<p>The <code>Life_stages</code> column specifies <strong>which life stage(s)</strong> (or specific vital rate) the stressor affects. The population model recognizes stage-specific tags and several convenient aliases.</p>
</section>
<section id="stage-specific-tags-recommended" class="level3" data-number="7.7.4">
<h3 data-number="7.7.4" class="anchored" data-anchor-id="stage-specific-tags-recommended"><span class="header-section-number">7.7.4</span> Stage-Specific Tags (Recommended)</h3>
<p>For clarity and precision, we recommend using explicit stage numbers:</p>
<p><strong>Survival ‘Life_stages’ Tags for Non-Anadromous Populations:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Life_stages Column</th>
<th>Target Vital Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>stage_E</code>, <code>SE</code></td>
<td>Egg survival</td>
</tr>
<tr class="even">
<td><code>stage_0</code>, <code>S0</code></td>
<td>Age-0 fry/sub-yearling survival</td>
</tr>
<tr class="odd">
<td><code>stage_1</code>, <code>S1</code>, <code>surv_1</code></td>
<td>Stage 1 survival</td>
</tr>
<tr class="even">
<td><code>stage_2</code>, <code>S2</code>, <code>surv_2</code></td>
<td>Stage 2 survival</td>
</tr>
<tr class="odd">
<td>… up to <code>stage_12</code></td>
<td>Higher stages as needed</td>
</tr>
</tbody>
</table>
<p><strong>Capacity ‘Life_stages’ Tags for Non-Anadromous Populations:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Tag(s)</th>
<th>Target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>SE</code>, <code>stage_E</code>, <code>KE</code></td>
<td>Egg capacity (Ke)</td>
</tr>
<tr class="even">
<td><code>stage_0</code>, <code>S0</code>, <code>K0</code></td>
<td>Fry capacity (K0)</td>
</tr>
<tr class="odd">
<td><code>stage_1</code>, <code>S1</code>, <code>K1</code></td>
<td>Stage 1 capacity</td>
</tr>
<tr class="even">
<td><code>stage_2</code>, <code>S2</code>, <code>K2</code></td>
<td>Stage 2 capacity</td>
</tr>
<tr class="odd">
<td>… up to <code>stage_12</code></td>
<td>Higher stages as needed</td>
</tr>
</tbody>
</table>
<section id="anadromous-specific-life_stages-tags" class="level4" data-number="7.7.4.1">
<h4 data-number="7.7.4.1" class="anchored" data-anchor-id="anadromous-specific-life_stages-tags"><span class="header-section-number">7.7.4.1</span> Anadromous-Specific <strong>‘Life_stages’</strong> Tags</h4>
<p>For anadromous species, additional Life_stages column tags target pre-breeder (Pb) and spawner (Breeder - B) classes:</p>
<p><strong>Pre-breeder Survival (Pb):</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>‘Life_stages’</strong> Tag(s)</th>
<th>Target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>stage_E</code>, <code>SE</code></td>
<td>Egg survival</td>
</tr>
<tr class="even">
<td><code>stage_0</code>, <code>S0</code></td>
<td>Age-0 fry/sub-yearling survival</td>
</tr>
<tr class="odd">
<td><code>stage_Pb_1</code></td>
<td>Pre-breeder stage 1 survival</td>
</tr>
<tr class="even">
<td><code>stage_Pb_2</code></td>
<td>Pre-breeder stage 2 survival</td>
</tr>
<tr class="odd">
<td>… up to <code>stage_Pb_12</code></td>
<td>Higher stages as needed</td>
</tr>
</tbody>
</table>
<p><strong>Pre-breeder Capacity (Pb):</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Tag(s)</th>
<th>Target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>stage_Pb_1</code></td>
<td>Pre-breeder stage 1 capacity</td>
</tr>
<tr class="even">
<td><code>stage_Pb_2</code></td>
<td>Pre-breeder stage 2 capacity</td>
</tr>
<tr class="odd">
<td>… up to <code>stage_Pb_12</code></td>
<td>Higher stages as needed</td>
</tr>
</tbody>
</table>
<p><strong>Spawner Capacity (B):</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th>Tag(s)</th>
<th>Target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>spawners</code></td>
<td>All spawner capacity (pooled across ages)</td>
</tr>
<tr class="even">
<td><code>spawn_1</code>, <code>spawners_1</code>, <code>B1</code>, <code>stage_B_1</code></td>
<td>Age-specific spawner capacity</td>
</tr>
<tr class="odd">
<td>… up to <code>spawn_12</code></td>
<td>Higher ages as needed</td>
</tr>
</tbody>
</table>
<p><strong>Pre-spawn and Migration Survival (Anadromous only):</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 54%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Tag(s)</th>
<th>Target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>spawners</code></td>
<td>All pre-spawn survival (u)</td>
</tr>
<tr class="even">
<td><code>prespawn_1</code>, <code>u1</code> … <code>u12</code></td>
<td>Age-specific pre-spawn survival</td>
</tr>
<tr class="odd">
<td><code>smig</code>, <code>spawn_mig</code></td>
<td>All spawner migration survival</td>
</tr>
<tr class="even">
<td><code>smig_1</code>, <code>spawn_mig_1</code> … <code>smig_12</code></td>
<td>Age-specific migration survival</td>
</tr>
</tbody>
</table>
</section>
<section id="fecundity-tags" class="level4" data-number="7.7.4.2">
<h4 data-number="7.7.4.2" class="anchored" data-anchor-id="fecundity-tags"><span class="header-section-number">7.7.4.2</span> Fecundity Tags</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Tag</th>
<th>Target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>eps</code></td>
<td>Eggs per spawner (all ages)</td>
</tr>
<tr class="even">
<td><code>eps_3</code>, <code>eps_4</code>, …</td>
<td>Age-specific fecundity (anadromous only)</td>
</tr>
</tbody>
</table>
</section>
<section id="notes-on-life_stages-linkage-tags-tags" class="level4" data-number="7.7.4.3">
<h4 data-number="7.7.4.3" class="anchored" data-anchor-id="notes-on-life_stages-linkage-tags-tags"><span class="header-section-number">7.7.4.3</span> Notes on <strong>‘Life_stages’ linkage Tags</strong> Tags</h4>
<ul>
<li>Tags are <strong>case-insensitive</strong> (converted to lowercase internally)</li>
<li><strong>Underscores and spaces are removed</strong> during processing (e.g., <code>stage_1</code> and <code>stage1</code> are equivalent)</li>
<li>You can specify <strong>multiple life stages</strong> separated by commas (e.g., <code>stage_1, stage_2</code>), but we recommend having a 1:1 relationship between a stressor-response relationship and a vital rate linkage. We recommend duplicating stressors in the stressor-magnitude and stressor-response relationship workbook for 1:many relationships between stressors and vital rates.</li>
</ul>
</section>
</section>
</section>
<section id="tips-on-building-a-new-life-cycle-profile-from-scratch" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="tips-on-building-a-new-life-cycle-profile-from-scratch"><span class="header-section-number">7.8</span> Tips on Building a New Life Cycle Profile From Scratch</h2>
<p>A customized life cycle profile can be developed using the following template: <a href="https://github.com/essatech/CEMPRAShiny/blob/main/data/demo/life%20cycles.csv">Life Cycle Profile Template</a>.</p>
<p>Appendix B includes sample species profiles for case study systems, such as Nicola Basin Chinook Salmon, Steelhead, and Coho Salmon. The COMPADRE (plant) and COMADRE (animal) online archives also offer vital rates for numerous species as of March 2023 (<a href="https://compadre-db.org/Data/Comadre">COMADRE Database</a>). These archives can be valuable resources for reviewing vital rate estimates for similar species and taxa.</p>
<p>It’s recommended to first summarize the species’ life cycle using a simple diagram to represent key life stages. This diagram can be converted into a periodicity table (or life history schedule) to represent time spent in each life stage, as shown in the figure. A life history diagram coupled with a periodicity table can be helpful in mapping out transitions between key stages in the life cycle model. Recall that the life cycle model works with annual time steps. “Census” periods within the matrix model do not need to fall precisely at the one-year interval, but care should be taken to ensure that key transitions are not missed or double-counted. It is best to start from the spawning period and work forward, following a whole generation to its progeny</p>
<div id="07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-07_life_cycle_model-fig-coho-salmon-lifecycle" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image055.png" class="img-fluid figure-img"></p>
<figcaption>Sample life cycle diagram and periodicity table for Coho Salmon</figcaption>
</figure>
</div>
<div>
<p>Sample combo life cycle diagram and periodicity table for a coastal population of Coho Salmon in British Columbia</p>
</div>
<p>Users can load a draft species profile into the R-Shiny application and modify it as needed. It is important to review the eigenanalysis of the projection matrix to ensure that lambda estimates, generation time, and stable-stage distributions align with expectations based on the species’ life history.</p>
<p><strong>Parameters to double-check:</strong></p>
<ul>
<li>Lambda (λ, instantaneous growth rates) estimates are reasonable (not substantially different from 1.0). If lambda estimates are lower than 1.0, review parameters.</li>
<li>Generation time approximately matches the characterization of the species’ life history in the literature.</li>
<li>Stable-stage distributions from the projection matrix are not substantially different from expectations.</li>
</ul>
</section>
<section id="benefits-and-limitations" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="benefits-and-limitations"><span class="header-section-number">7.9</span> Benefits and Limitations</h2>
<p>The life cycle modeling component of the CEMPRA tool is a valuable resource for understanding and quantifying cumulative effects, linking critical stressors to key life stages, and supporting an understanding of the relevance of key drivers curtailing productivity and capacity. Related analyses have provided a useful framework to synthesize pathways for cumulative effects through the lens of population ecology (<span class="citation" data-cites="beechie2021modeling">(<a href="references.html#ref-beechie2021modeling" role="doc-biblioref">Beechie et al., 2021</a>)</span>; <span class="citation" data-cites="jorgensen2021identifying">(<a href="references.html#ref-jorgensen2021identifying" role="doc-biblioref">Jorgensen et al., 2021</a>)</span>; <span class="citation" data-cites="sorel2022informing">(<a href="references.html#ref-sorel2022informing" role="doc-biblioref">Sorel, 2022</a>)</span>; <span class="citation" data-cites="kendall2023life">(<a href="references.html#ref-kendall2023life" role="doc-biblioref">Kendall et al., 2023</a>)</span>). Simulations allow user groups to play out hypothetical scenarios with multiple stressors, locations, and species profiles, making it possible to perform many complex calculations within a simple user interface.</p>
<p>However, there are key limitations to the CEMPRA tool and life cycle modeling in general. Depending on the parameterization of a species profile, there can be key stages and vital rates that are highly sensitive to perturbation. It can be challenging to discern whether these sensitivities reflect actual vulnerabilities in nature or are artifacts of the modeling framework. Therefore, some researchers emphasize the need to treat life cycle models as hypothesis generators until predictions and causal pathways can be empirically validated (<span class="citation" data-cites="roni2018review">(<a href="references.html#ref-roni2018review" role="doc-biblioref">Roni et al., 2018</a>)</span>).</p>
<p>The CEMPRA tool does not account for complex variations in life history strategies, seasonal movement, individual exposure, and detailed habitat criteria. Therefore, it’s up to the users to carefully design stressor variables, stressor magnitude datasets, and stressor-response relationships such that linkages are already largely accounted for in the underlying input data. When summarizing results, it is advisable for user groups to focus on reviewing relative differences between scenarios compared to a default (status-quo) reference scenario. Interpreting results as relative differences is more relatable than trying to rationalize absolute values (e.g., <em>“scenario A increased system capacity by ~10% relative to scenario B”</em> vs <em>“scenario A increased capacity by 321 fish relative to scenario B”</em>).</p>
<p>User groups and practitioners should use life cycle models to help develop high-level goals for restoration and recovery programs (<span class="citation" data-cites="roni2018review">(<a href="references.html#ref-roni2018review" role="doc-biblioref">Roni et al., 2018</a>)</span>). While useful for identifying key demographic bottlenecks and the sensitivity of those bottlenecks to the range of stressor values observed on the landscape (or projected through simulation), life cycle models are less useful for designing small-scale projects. Efforts should continue to validate and refine predictions with field data and empirical studies.</p>
<p><strong>Review applicable R-package tutorials to explore this further - <a href="https://essatech.github.io/CEMPRA/index.html">Tutorials</a>.</strong></p>
<hr>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-beechie2021modeling" class="csl-entry" role="listitem">
Beechie, T. J., Nicol, C., Fogel, C., Jorgensen, J., Thompson, J., Seixas, G., Chamberlin, J., Hall, J., Timpane-Padgham, B., Kiffney, P., Kubo, S., &amp; Keaton, J. (2021). <em>Modeling effects of habitat change and restoration alternatives on salmon in the chehalis river basin using a salmonid life-cycle model</em> (NMFS-NWFSC-CR-2021-01). U.S. Department of Commerce, NOAA.
</div>
<div id="ref-caswell1997" class="csl-entry" role="listitem">
Caswell, H. (1997). Matrix methods for population analysis. In S. Tuljapurkar &amp; H. Caswell (Eds.), <em>Structured-population models in marine, terrestrial, and freshwater systems</em> (pp. 19–58). Springer US. <a href="https://doi.org/10.1007/978-1-4615-6005-0_2">https://doi.org/10.1007/978-1-4615-6005-0_2</a>
</div>
<div id="ref-Chen2024ChinookCV" class="csl-entry" role="listitem">
Chen, E. K. (2024). <em>Life history and population dynamics of chinook salmon in the central valley</em> [Ph.D. dissertation]. University of California, Berkeley.
</div>
<div id="ref-CoxRogersEtAl2010SkeenaSockeye" class="csl-entry" role="listitem">
Cox-Rogers, S., Hume, J. M. B., Shortreed, K. S., &amp; Spilsted, B. (2010). <em>A risk assessment model for skeena river sockeye salmon</em> (2920; Canadian Manuscript Report of Fisheries and Aquatic Sciences). Fisheries; Oceans Canada.
</div>
<div id="ref-cramer2009linking" class="csl-entry" role="listitem">
Cramer, S. P., &amp; Ackerman, N. K. (2009). Linking stream carrying capacity for salmonids to habitat features. <em>American Fisheries Society Symposium</em>, <em>71</em>, 225–254.
</div>
<div id="ref-davison2016" class="csl-entry" role="listitem">
Davison, R. J., &amp; Satterthwaite, W. H. (2016). Use of age and stage structured matrix models to predict life history schedules for semelparous populations. <em>Natural Resource Modeling</em>, <em>29</em>(4), 538–558. <a href="https://doi.org/10.1111/nrm.12109">https://doi.org/10.1111/nrm.12109</a>
</div>
<div id="ref-jorgensen2021identifying" class="csl-entry" role="listitem">
Jorgensen, J. C., Nicol, C., Fogel, C., &amp; Beechie, T. J. (2021). Identifying the potential of anadromous salmonid habitat restoration with life cycle models. <em>Plos One</em>, <em>16</em>(9), e0256792.
</div>
<div id="ref-kendall2023life" class="csl-entry" role="listitem">
Kendall, N. W., Unrein, J., Volk, C., Beauchamp, D. A., Fresh, K. L., &amp; Quinn, T. P. (2023). Life cycle model reveals sensitive life stages and evaluates recovery options for a dwindling pacific salmon population. <em>North American Journal of Fisheries Management</em>, <em>43</em>(1), 203–230.
</div>
<div id="ref-roni2018review" class="csl-entry" role="listitem">
Roni, P., Anders, P. J., Beechie, T. J., &amp; Kaplowe, D. J. (2018). Review of tools for identifying, planning, and implementing habitat restoration for pacific salmon and steelhead. <em>North American Journal of Fisheries Management</em>, <em>38</em>(2), 355–376.
</div>
<div id="ref-schaub2021" class="csl-entry" role="listitem">
Schaub, M., &amp; Kéry, M. (2021). <em>Integrated population models: Theory and ecological applications with r and JAGS</em>. Academic Press.
</div>
<div id="ref-sorel2022informing" class="csl-entry" role="listitem">
Sorel, M. (2022). <em>Informing salmon conservation with life cycle models that account for individual heterogeneity</em> [PhD thesis]. University of Washington.
</div>
<div id="ref-vanderlee2020" class="csl-entry" role="listitem">
Van der Lee, A. S., &amp; Koops, M. A. (2020). <em>Recovery potential modelling of westslope cutthroat trout (oncorhynchus clarkii lewisi) in designatable unit 1: Saskatchewan-nelson river populations</em> (Research Document 2020/020). Canadian Science Advisory Secretariat. <a href="https://www.dfo-mpo.gc.ca/csas-sccs/publications/resdocs-docrech/2020/2020_020-eng.html">https://www.dfo-mpo.gc.ca/csas-sccs/publications/resdocs-docrech/2020/2020_020-eng.html</a>
</div>
<div id="ref-ward1993egg" class="csl-entry" role="listitem">
Ward, B. R., &amp; Slaney, P. A. (1993). Egg-to-smolt survival and fry-to-smolt density dependence of keough river steelhead trout. <em>Canadian Special Publication of Fisheries and Aquatic Sciences</em>, 209–217.
</div>
</div>
</section>

<p>Leave questions and comments below (via your GitHub account)</p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/mattjbayly\.github\.io\/CEMPRA_documentation\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="mattjbayly/CEMPRA_documentation" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06_r_shiny_app.html" class="pagination-link" aria-label="Joe Model &amp; Shiny App">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Joe Model &amp; Shiny App</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08_stressor_response_library.html" class="pagination-link" aria-label="Stressor-Response Library">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Stressor-Response Library</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>