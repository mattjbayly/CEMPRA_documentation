<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CEMPRA Guidance Document - 6&nbsp; R-Shiny Application</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07_life_cycle_model.html" rel="next">
<link href="./05_data_inputs.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./06_r_shiny_app.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R-Shiny Application</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CEMPRA Guidance Document</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CEMPRA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_stressor_response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Stressor-Response Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_pathways_endpoints.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelling Pathways and Assessment Endpoints</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_initial_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Setup and Installation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_data_inputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Inputs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_r_shiny_app.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R-Shiny Application</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_life_cycle_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Life Cycle Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_stressor_response_library.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Stressor-Response Library</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_case_study_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Example Datasets</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_r_package_tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">R Package Tutorials</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_conclusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Concluding Remarks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_interaction_matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Multi-Stressor Interaction Matrix</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#about" id="toc-about" class="nav-link active" data-scroll-target="#about"><span class="header-section-number">6.1</span> About</a></li>
  <li><a href="#upload-data" id="toc-upload-data" class="nav-link" data-scroll-target="#upload-data"><span class="header-section-number">6.2</span> Upload Data</a></li>
  <li><a href="#map-overview" id="toc-map-overview" class="nav-link" data-scroll-target="#map-overview"><span class="header-section-number">6.3</span> Map Overview</a>
  <ul class="collapse">
  <li><a href="#map-window" id="toc-map-window" class="nav-link" data-scroll-target="#map-window"><span class="header-section-number">6.3.1</span> Map Window</a></li>
  <li><a href="#stressors" id="toc-stressors" class="nav-link" data-scroll-target="#stressors"><span class="header-section-number">6.3.2</span> Stressors</a></li>
  <li><a href="#joe-model" id="toc-joe-model" class="nav-link" data-scroll-target="#joe-model"><span class="header-section-number">6.3.3</span> Joe Model</a></li>
  <li><a href="#system-capacity-plots" id="toc-system-capacity-plots" class="nav-link" data-scroll-target="#system-capacity-plots"><span class="header-section-number">6.3.4</span> System Capacity Plots</a></li>
  <li><a href="#adjust-magnitude" id="toc-adjust-magnitude" class="nav-link" data-scroll-target="#adjust-magnitude"><span class="header-section-number">6.3.5</span> Adjust Magnitude</a></li>
  <li><a href="#life-cycle-model" id="toc-life-cycle-model" class="nav-link" data-scroll-target="#life-cycle-model"><span class="header-section-number">6.3.6</span> Life Cycle Model</a></li>
  </ul></li>
  <li><a href="#download-data" id="toc-download-data" class="nav-link" data-scroll-target="#download-data"><span class="header-section-number">6.4</span> Download Data</a></li>
  <li><a href="#interactive-formula-builder" id="toc-interactive-formula-builder" class="nav-link" data-scroll-target="#interactive-formula-builder"><span class="header-section-number">6.5</span> Interactive Formula Builder</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R-Shiny Application</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The R Shiny web application is a user-friendly interface for the CEMPRA powered by the <em>CEMPRA</em> R package. Users can access a working version R Shiny application hosted <a href="https://essa.shinyapps.io/CEMPRAShiny">here</a>. The following section is intended to walk new users through the components of the R Shiny web application.</p>
<section id="about" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="about"><span class="header-section-number">6.1</span> About</h2>
<p>When you first access the R Shiny web application for the CEMPRA, you will be automatically directed to the <strong>About</strong> page. This page contains a brief introduction to the application and the CEMPRA (Joe Model) tool, a list of contributors, and a list of features for users to explore. A tutorial video is also embedded on this webpage to guide users through the application.</p>
<div id="fig-figure14" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image025.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.1: About page in the R Shiny web application. 1) Tutorial video for using the R Shiny application. 2) Brief introduction to the CEMPRA and associated life cycle model. 3) List of contributors to the CEMPRA. 4) List of features included in the R Shiny web application. 5) Menu for the R Shiny application</figcaption>
</figure>
</div>
</section>
<section id="upload-data" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="upload-data"><span class="header-section-number">6.2</span> Upload Data</h2>
<p>If you would like to import a custom set of stressor-response functions, spatial polygons, or vital rates (for the life cycle model), select the <strong>Upload Data</strong> page in the menu on the left side of the screen. This page allows you to upload four key input files from your computer: the stressor-response workbook (.xlsx), the stressor-magnitude workbook (.xlsx), a spatial polygons file (.gpkg or .shp), and a life cycle profile (.csv). To upload a file from your computer, click “Browse…” on the toolbar below the associated file heading. Next, select the desired file from the file window and click “Open”. The file will begin to upload. A status bar will appear below the file name, indicating the upload status. Once the file has been successfully uploaded, the status bar will display “Upload complete”.</p>
<div id="fig-figure15" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image026.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.2: Data upload page of the R Shiny web application. 1) Instructions for uploading files. 2) Location to upload stressor-response workbook (.xlsx). 3) Location to upload stressor magnitude workbook (.xlsx). 4) Location to upload spatial polygons file (.gpkg or .shp). 5) Location to upload life cycle profile (.csv).</figcaption>
</figure>
</div>
</section>
<section id="map-overview" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="map-overview"><span class="header-section-number">6.3</span> Map Overview</h2>
<section id="map-window" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="map-window"><span class="header-section-number">6.3.1</span> Map Window</h3>
<p>The map window on the <strong>Map Overview</strong> page allows users to view stressor magnitudes and model results in a choropleth map based on the spatial polygons layer you imported. The map in the centre of the screen is interactive and allows users to scroll, zoom, and select individual polygons. When hovering over a polygon, users will see the name and HUC_ID of that polygon displayed directly above the map window. To select a polygon, click on it once. Selected polygons will appear in blue. Clicking on additional polygons will add to your selection. To deselect a polygon, click it again. The number of selected polygons (HUCs) will appear below the map window on the left-hand side. Click the “deselect all” button beside this text string to deselect all polygons.</p>
</section>
<section id="stressors" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="stressors"><span class="header-section-number">6.3.2</span> Stressors</h3>
<p>On the <strong>Map Overview</strong> page, users can view stressor-response relationships for each of the stressors included in the input stressor-response Excel workbook. A list of these stressors is on the screen’s right side. Clicking on the chart icon next to one of the stressors opens a pop-up window to view the stressor-response curve and raw stressor-response table associated with that specific stressor. You can edit cell values within the stressor-response table by double-clicking on the cell you want to edit. Any edits to the stressor-response table will automatically appear in the stressor-response curve.</p>
<div id="fig-figure16" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image028.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.3: Stressor-response relationship pop-up window example. 1) Description of table and stressor-response curve. 2) Stressor-response curve plot. 3) Stressor-response curve input table. 4) List of stressors used in the CEMPRA (Joe Model).</figcaption>
</figure>
</div>
</section>
<section id="joe-model" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="joe-model"><span class="header-section-number">6.3.3</span> Joe Model</h3>
<p>To run the Joe Model, click the “Joe Model” button in the centre of the lower panel. In the pop-up window, you can select/deselect variables that you want to include/exclude in the Joe Model run. In addition, you can specify the number of simulations or batch runs you would like to conduct (in the “Number of Simulations” box), and you can provide a name for the simulation (in the “Name of this Simulation” box). When you are ready to run the Joe Model for all spatial polygons in the study area, click “Run the Joe Model”. Note there is currently no option to run the Joe Model for individual spatial polygons.</p>
<div id="fig-figure17" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image029.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.4: Pop-up window for the Joe Model. 1) Variables to include/exclude from cumulative effects modelling. 2) Inputs for the number of simulations and the name of the simulation. 3) Button to run the Joe Model. 4) Button to bring up the pop-up window.</figcaption>
</figure>
</div>
</section>
<section id="system-capacity-plots" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="system-capacity-plots"><span class="header-section-number">6.3.4</span> System Capacity Plots</h3>
<p>After running the Joe Model, a new section labelled “System Capacity Plots” will appear at the bottom of the map page. You can view tables and plots of the cumulative system capacity for selected watersheds (click “Selected watersheds”) or for all watersheds (click “All watersheds”) compared to the global mean system capacity across all simulations.</p>
<p>System capacity plots show the scaled probability output from the Joe Model from stochastic simulations.</p>
<div id="fig-figure18" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image030.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.5: System capacity plots for eleven spatial units (locations) showing the cumulative system capacity scores (mean, median and scaled probability distributions).</figcaption>
</figure>
</div>
</section>
<section id="adjust-magnitude" class="level3" data-number="6.3.5">
<h3 data-number="6.3.5" class="anchored" data-anchor-id="adjust-magnitude"><span class="header-section-number">6.3.5</span> Adjust Magnitude</h3>
<p>Users may wish to modify stressor values to represent recovery action or habitat loss. To view and edit stressor magnitudes for an individual spatial polygon, select the spatial polygon of interest and click “Adjust Magnitude” on the right-hand side of the lower panel. Next, review the mean system capacity in the pop-up window for one or more selected locations. Below this, a table containing all the stressors, their magnitudes and distributions will be displayed. Double-click on the desired cell to edit any of the values in this table. Adjust the mean value for each stressor (Mean), the standard deviation (SD), the distribution type (options are normal or lognormal), and the lower limit and upper limit (for stochastic simulations). Note that stressor names and system capacity values cannot be edited. If only one HUC is selected, values will appear in the table; however, if multiple HUCs are selected, the table will appear blank. When multiple HUCs are selected, all modified values will be shared across the selected HUCs. The mean system capacity is shown for selected HUCs to preview the model output.</p>
<div id="fig-figure19" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image031.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.6: Example of single or multi-location stressor magnitude adjustment across spatial units.</figcaption>
</figure>
</div>
</section>
<section id="life-cycle-model" class="level3" data-number="6.3.6">
<h3 data-number="6.3.6" class="anchored" data-anchor-id="life-cycle-model"><span class="header-section-number">6.3.6</span> Life Cycle Model</h3>
<p>To run the life cycle model associated with the CEMPRA, first select (click) the desired spatial polygons for the run. Once the desired spatial polygons are selected, click the “Life cycle model” button on the left side of the lower panel. In the pop-up window that appears, enter the number of years (in the “N-years” box) and the number of replicates or batch runs (in the “N-replicates” box). When ready to run the life cycle model for the selected spatial polygons, click “Run Life cycle model”.</p>
<p>After the run is complete, three graph panels will appear in the pop-up window. The first panel displays time series projections of the number of individuals by life stage and a time series of lambda values for adults. The second-panel plots abundance at different life stages in the selected spatial polygon(s) compared to a baseline condition. The third-panel plots stressor magnitude against system capacity (0-1) for each of the stressors used in the model. You can view individual data points by hovering over the plot with your cursor. When hovering over the plot, you will also see a menu appear in the top right-hand corner of the plotting window. This menu allows you to pan and zoom around the plot and download a snapshot of the plot onto your computer.</p>
<p><img src="images/image032.png" id="fig-figure20" class="img-fluid" alt="Pop-up window for the life cycle model. 1) Input boxes for the number of years and number of replicates in the simulation. 2) The button to run the life cycle model. 3) Plotting window for time series projection plots."> ## Life Cycle Model</p>
<p>The life cycle model is included as an extension to the original CEMPRA. It leverages a flexible stage-structured life cycle modeling framework that can be modified for different target systems. The underlying life cycle model code was originally developed by van der Lee and Koops (2020) and then further modified by Dr.&nbsp;Kyle Wilson to incorporate environmental stressors that are linked to survivorship, capacity, and growth.</p>
<p>If you intend to use the coupled life cycle model along with the Joe Model, click on the <strong>Life cycle model</strong> page in the menu on the left-hand side of the screen. This page will display all of the parameters and vital rates being used as inputs for the life cycle model. To edit any of these parameters, click anywhere inside the box for a given parameter and either manually enter a new number, or use the up and down arrows that appear on the right side of the box to incrementally adjust the value. Refer to Section 7 for background and additional details on the life cycle modeling component of the CEMPRA tool.</p>
<div id="fig-figure21" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image033.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.7: Life cycle model page of the R Shiny application. 1) Input section for population vital rates. 2) Parameters for density-independent and density-dependent components of the model. 3) Sandbox for conducting sample runs of the life cycle model.</figcaption>
</figure>
</div>
<p>Matrix elements and derived parameters from the life cycle model are shown in the upper right corner of the page. These values will update in real-time as users change the inputs. Lambda values are useful because they show if population parameters will cause the population to grow (lambda greater than 1) or shrink over time (lambda less than 1). Generation time can also be useful to reference against the target population of interest.</p>
<p>Clicking on the “Eigen Analysis” button will bring up a full modal display showing the derived transition matrix, elasticities, sensitivities, net reproductive rates, and stable stage distributions.</p>
<div id="fig-figure22" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image034.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.8: Full eigen analysis showing the transition matrix, sensitivity matrix, elasticity matrix, stable stage distribution estimate of the intrinsic population growth rate (lambda), generation time, and damping ratio.</figcaption>
</figure>
</div>
<p>The symbolic representation of the transition matrix can also be reviewed by clicking on the “Symbolic Representations” button. Additional explainer popups are also available throughout the page.</p>
<div id="fig-figure23" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image035.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.9: Symbolic (equation) representation of the transition matrix and density dependence matrix.</figcaption>
</figure>
</div>
<p>In the bottom left-hand corner of the page is a population projection “sandbox” module. This section allows the user to run sample projections of the population forward through time over a set number of years and batch replicates. Adjusting any of the life cycle parameters and re-running the sandbox projection will allow the user to see how their changes influence the growth trajectory and variability of the population. Running simulations is valuable since it allows users to capture density-dependent and density-independent components of the life cycle model. Separate time series are drawn for the current (red) and previous (teal) projections. The mean value (across batch replicates) is shown as a line, and the grey shading shows the variability across each batch replicate (<a href="#fig-figure24">Figure&nbsp;<span>6.10</span></a>).</p>
<p>The sandbox module can also be used to run sample projections for hypothetical combinations of stressor values. Stressor variables linked to the life cycle model and uploaded by the user will appear below the “Demo Projection Time Series” button. Users can populate these values to demonstrate how an individual stressor (or group of stressors) will influence the population at a set of hypothetical values. Be sure to expand the panel for each stressor and values for the mean, SD, lower limit, and upper limit. Check or uncheck the checkbox to include or exclude the stressor in the sandbox simulations.</p>
<div id="fig-figure24" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image036.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.10: Population projection “sandbox” showing stage-specific abundance values for current and previous model runs. Users may change values such as fecundity or a stressor to visualize how the population will respond to hypothetical changes to parameters (outside of formalized scenario runs).</figcaption>
</figure>
</div>
</section>
</section>
<section id="download-data" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="download-data"><span class="header-section-number">6.4</span> Download Data</h2>
<p>On the <strong>Download Data</strong> page, you can either download the model input parameter files (i.e., the stressor-response workbook, stressor magnitude workbook, spatial polygons file, and life cycle profile) for offline revisions, or you can directly download the CEMPRA, or Life cycle model outputs for reporting purposes.</p>
<p><strong>Model Parameters</strong>: In some circumstances, it may be more convenient to download the stressor magnitude and response Excel workbooks, edit inputs for scenarios offline in Excel or other software and reupload.</p>
<p><strong>Model Exports</strong>: The model results can only be exported after the model is run. Export buttons will be disabled until the Joe Model or life cycle model (population model) has been run.</p>
<div id="fig-figure25" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image037.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.11: Download the Data page of the R Shiny Application. 1) Model parameter files for download. 2) Model output files for download (CEMPRA and life cycle model).</figcaption>
</figure>
</div>
</section>
<section id="interactive-formula-builder" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="interactive-formula-builder"><span class="header-section-number">6.5</span> Interactive Formula Builder</h2>
<p>*** (March 22, 2023): This component is still in development and not yet available on the GitHub repository application ***</p>
<p>The interactive formula builder is used to generate custom plots of stressor variables with customized functions and potential interactions between variables. The interactive formula builder provides users with the ability to display outputs from customized regression equations.</p>
<p>A dialogue box is available, allowing users to drag and drop multiple stressors into a formula builder to display relationships and interactions (e.g., 0.45 + stressor_A^0.3 + stressor_B*stressor_C). Various mathematical operators can be included in the formula builder:</p>
<ul>
<li>Addition: +; Stressor_A + Stressor_B</li>
<li>Subtraction: -; Stressor_A - Stressor_B</li>
<li>Constants: 0.783 + Stressor_A</li>
<li>Multiplication: <em>; Stressor_A </em> Stressor_B</li>
<li>Division: /; Stressor_A / Stressor_B</li>
<li>Brackets: (); (0.783 + Stressor_A) / Stressor_B</li>
<li>Exponents: ^; Stressor_A^(0.34 * Stressor_B)</li>
<li>Logarithms:
<ul>
<li>Natural: log(Stressor_A)</li>
<li>Base-10: log10(Stressor_A)</li>
</ul></li>
</ul>
<p>The interactive formula builder can be useful to display outputs from various habitat suitability models, predictive regression equations, alternative cumulative effects roll-up functions or building novel stressors.</p>
<p><strong>Building Novel Stressors</strong>: The interactive formula builder can also be used to build novel stressor variables that consist of combinations of individual stressors. Users enter values into the formula builder to create a synthetic stressor variable. Once satisfied, users can download the novel stressor in the standardized stressor magnitude and stressor-response workbook format. The novel data can then be reimported into the tool to appear on the main map panel for use in the Joe Model and Life Cycle Model.</p>
<div id="fig-figure26" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image038.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.12: Interactive formula builder module</figcaption>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05_data_inputs.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Inputs</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./07_life_cycle_model.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Life Cycle Model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>